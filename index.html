<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Golos+Text:wght@400..900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<title>CREATION DOE</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
<style>
			body {
			font-family: "Golos Text", sans-serif;
			color: #3b3a38;
			background-color: #3b3a38;
			margin: 0;
			padding: 20px;
			}
			.container {
			max-width: 950px;
			margin: auto;
			background-color: #f4f4f4;
			padding: 50px;
			border-radius: 5px;
			box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
			}
			h1 {
			text-align: center;
			}
			form {
			display: flex;
			flex-direction: column;
			gap: 10px;
			}
			table {
			width: 100%;
			margin-bottom: 20px;
			border-collapse: collapse;
			}
			table,
			th,
			td {
			border: 1px solid #ccc;
			padding: 10px;
			text-align: left;
			}
			.ft-1 {
			background-color: #3290a1;
			color: white;
			font-weight: bold;
			width: 30%;
			}
			.ft-2 {
			background-color: #3290a1;
			color: white;
			font-weight: bold;
			width: 25%;
			}
			.ft-3 {
			background-color: #3290a1;
			color: white;
			font-weight: bold;
			width: 25%;
			}
			.ft-4 {
			background-color: #3290a1;
			color: white;
			font-weight: bold;
			width: 20%;
			}
			.h-ft {
			color: #3290a1;
			font-weight: bold;
			}
			.pv-1 {
			background-color: #1e375c;
			color: white;
			font-weight: bold;
			width: 55%;
			}
			.pv-2 {
			background-color: #1e375c;
			color: white;
			font-weight: bold;
			width: 45%;
			}
			.h-pv {
			color: #1e375c;
			font-weight: bold;
			}
			.sch-1 {
			background-color: #cc6b16;
			color: white;
			font-weight: bold;
			width: 55%;
			}
			.sch-2 {
			background-color: #cc6b16;
			color: white;
			font-weight: bold;
			width: 45%;
			}
			.h-sch {
			color: #cc6b16;
			font-weight: bold;
			}
			.doe-1 {
			background-color: #575653;
			color: white;
			font-weight: bold;
			width: 30%;
			}
			.h-doe {
			color: #575653;
			font-weight: bold;
			}
			input,
			select,
			file {
			padding: 10px;
			width: 100%;
			box-sizing: border-box;
			}
	
			button {
			    color: white;
			    border: none;
			    cursor: pointer;
			    padding: 10px;
			    border-radius: 3px;
			}
			
			.primary-btn {
			    background-color: #1c1b1a;
			    width: 40%;
			    min-width: 120px;
			}
			
			.save-btn,
			.load-btn {
			    background-color: #3b3a38;
			    width: 50%;
			}
			
			.save-btn:hover {
			    background-color: #1c1b1a; /* Blue */
			}
			
			.load-btn:hover {
			    background-color: #1c1b1a; /* Lighter Blue */
			}
			
			.primary-btn:hover {
			    background-color: #6b852e;
			}
			.dropzone-container {
			display: flex;
			align-items: center;
			gap: 10px;
			/* Add space between the drop zone and the cross icon */
			}
			.dropzone {
			flex-grow: 1;
			max-width: calc(100% - 20px);
			/* Adjust width to make room for the remove icon */
			border: 1px dashed #999999;
			border-radius: 3px;
			padding: 15px;
			text-align: center;
			color: #999999;
			font-size: 14px;
			cursor: pointer;
			transition: background-color 0.3s ease;
			}
			.dropzone.dragover {
			background-color: #ffffff;
			}
			.remove-file {
			display: inline-block;
			cursor: pointer;
			font-size: 18px;
			color: #d9534f;
			user-select: none;
			}
			.loader {
			display: none; /* Initially hidden */
			border: 5px solid #c2bdba;
			border-top: 5px solid #3b3a38;
			border-radius: 50%;
			width: 20px;
			height: 20px;
			animation: spin 1s linear infinite;
			margin-right: 10px; /* Add margin to the right for spacing */
			vertical-align: middle; /* Align with the button */
			}
	
			@keyframes spin {
			0% {
			transform: rotate(0deg);
			}
			100% {
			transform: rotate(360deg);
			}
			}
			input[type="file"] {
			display: none;
			}
		</style>
</head>
<body>
<div class="container">
<form id="upload-form">
<h2 class="h-doe">DOSSIER DES OUVRAGES EXECUTÉS</h2>
<table>
<tbody>
<tr>
<td class="doe-1">
<label for="adresse">ADRESSE</label>
</td>
<td>
<input id="adresse" placeholder="Entrer Adresse" required="" type="text"/>
</td>
</tr>
<tr>
<td class="doe-1">
<label for="postal-city">CODE POSTAL &amp; VILLE</label>
</td>
<td>
<input id="postal-city" list="city-options" placeholder="Commencez à saisir le code postal..." required="" type="text"/>
<datalist id="city-options"></datalist>
</td>
</tr>
<tr>
<td class="doe-1">
<label for="objet">OBJET</label>
</td>
<td>
<select id="objet" required="">
<option value="">Choisissez l'objet</option>
<option value="renovation chaufferie">
										RENOVATION CHAUFFERIE
									</option>
<option value="renovation sous-station">
										RENOVATION SOUS-STATION
									</option>
</select>
</td>
</tr>
<tr>
<td class="doe-1">
<label for="date">DATE</label>
</td>
<td><input id="date" required="" type="date"/></td>
</tr>
</tbody>
</table>
<!-- Fiches Techniques Table -->
<hr/>
<h2 class="h-ft">FICHES TECHNIQUES</h2>
<table>
<thead>
<tr>
<th class="ft-1">MATERIEL</th>
<th class="ft-2">MARQUE</th>
<th class="ft-3">MODELE</th>
<th class="ft-4">FICHIER</th>
</tr>
</thead>
<tbody>
<tr class="fiches-techniques-row">
<td>ADOUCISSEUR</td>
<td>
<input class="marque-input" list="marque-list-adoucisseur" type="text"/>
<datalist id="marque-list-adoucisseur"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-adoucisseur" type="text"/>
<datalist id="modele-list-adoucisseur"></datalist>
<td>
<div class="dropzone" id="adoucisseur-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="adoucisseur-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>AQUASTAT ECS</td>
<td>
<input class="marque-input" list="marque-list-aquastat" type="text"/>
<datalist id="marque-list-aquastat"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-aquastat" type="text"/>
<datalist id="modele-list-aquastat"></datalist>
<td>
<div class="dropzone" id="aquastat-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="aquastat-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>BALLON ECS</td>
<td>
<input class="marque-input" list="marque-list-ballon-ecs" type="text"/>
<datalist id="marque-list-ballon-ecs"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-ballon-ecs" type="text"/>
<datalist id="modele-list-ballon-ecs"></datalist>
<td>
<div class="dropzone" id="ballon-ecs-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="ballon-ecs-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>CHAUDIERE</td>
<td>
<input class="marque-input" list="marque-list-chaudiere" type="text"/>
<datalist id="marque-list-chaudiere"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-chaudiere" type="text"/>
<datalist id="modele-list-chaudiere"></datalist>
<td>
<div class="dropzone" id="chaudiere-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="chaudiere-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>DESEMBOUEUR MAGNETIQUE</td>
<td>
<input class="marque-input" list="marque-list-desemboueur" type="text"/>
<datalist id="marque-list-desemboueur"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-desemboueur" type="text"/>
<datalist id="modele-list-desemboueur"></datalist>
<td>
<div class="dropzone" id="desemboueur-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="desemboueur-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>ECHANGEUR CPCU</td>
<td>
<input class="marque-input" list="marque-list-echangeur-cpcu" type="text"/>
<datalist id="marque-list-echangeur-cpcu"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-echangeur-cpcu" type="text"/>
<datalist id="modele-list-echangeur-cpcu"></datalist>
<td>
<div class="dropzone" id="echangeur-cpcu-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="echangeur-cpcu-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>ECHANGEUR DE DISCONNEXION</td>
<td>
<input class="marque-input" list="marque-list-echangeur" type="text"/>
<datalist id="marque-list-echangeur"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-echangeur" type="text"/>
<datalist id="modele-list-echangeur"></datalist>
<td>
<div class="dropzone" id="echangeur-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="echangeur-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>ELECTROVANNE GAZ</td>
<td>
<input class="marque-input" list="marque-list-electrovanne-gaz" type="text"/>
<datalist id="marque-list-electrovanne-gaz"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-electrovanne-gaz" type="text"/>
<datalist id="modele-list-electrovanne-gaz"></datalist>
<td>
<div class="dropzone" id="electrovanne-gaz-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="electrovanne-gaz-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>GROUPE DE MAINTIEN DE PRESSION</td>
<td>
<input class="marque-input" list="marque-list-groupe-maintien" type="text"/>
<datalist id="marque-list-groupe-maintien"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-groupe-maintien" type="text"/>
<datalist id="modele-list-groupe-maintien"></datalist>
<td>
<div class="dropzone" id="groupe-maintien-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="groupe-maintien-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>POMPE BALLON ECS</td>
<td>
<input class="marque-input" list="marque-list-pompe-ballon" type="text"/>
<datalist id="marque-list-pompe-ballon"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-pompe-ballon" type="text"/>
<datalist id="modele-list-pompe-ballon"></datalist>
<td>
<div class="dropzone" id="pompe-ballon-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="pompe-ballon-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>POMPE CHARGE CHAUDIERE</td>
<td>
<input class="marque-input" list="marque-list-pompe-charge-chaudiere" type="text"/>
<datalist id="marque-list-pompe-charge-chaudiere"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-pompe-charge-chaudiere" type="text"/>
<datalist id="modele-list-pompe-charge-chaudiere"></datalist>
<td>
<div class="dropzone" id="pompe-charge-chaudiere-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="pompe-charge-chaudiere-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>POMPE CHAUFFAGE</td>
<td>
<input class="marque-input" list="marque-list-pompe-chauffage" type="text"/>
<datalist id="marque-list-pompe-chauffage"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-pompe-chauffage" type="text"/>
<datalist id="modele-list-pompe-chauffage"></datalist>
<td>
<div class="dropzone" id="pompe-chauffage-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="pompe-chauffage-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>POMPE DE RELEVAGE</td>
<td>
<input class="marque-input" list="marque-list-pompe-relevage" type="text"/>
<datalist id="marque-list-pompe-relevage"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-pompe-relevage" type="text"/>
<datalist id="modele-list-pompe-relevage"></datalist>
<td>
<div class="dropzone" id="pompe-relevage-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="pompe-relevage-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>POMPE PRIMAIRE ECS</td>
<td>
<input class="marque-input" list="marque-list-pompe-primaire" type="text"/>
<datalist id="marque-list-pompe-primaire"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-pompe-primaire" type="text"/>
<datalist id="modele-list-pompe-primaire"></datalist>
<td>
<div class="dropzone" id="pompe-primaire-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="pompe-primaire-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>POMPE RECYCLAGE ECS</td>
<td>
<input class="marque-input" list="marque-list-pompe-recyclage" type="text"/>
<datalist id="marque-list-pompe-recyclage"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-pompe-recyclage" type="text"/>
<datalist id="modele-list-pompe-recyclage"></datalist>
<td>
<div class="dropzone" id="pompe-recyclage-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="pompe-recyclage-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>PREPARATEUR ECS</td>
<td>
<input class="marque-input" list="marque-list-preparateur-ecs" type="text"/>
<datalist id="marque-list-preparateur-ecs"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-preparateur-ecs" type="text"/>
<datalist id="modele-list-preparateur-ecs"></datalist>
<td>
<div class="dropzone" id="preparateur-ecs-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="preparateur-ecs-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>PRESSOSTAT MANQUE D'EAU</td>
<td>
<input class="marque-input" list="marque-list-pressostat" type="text"/>
<datalist id="marque-list-pressostat"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-pressostat" type="text"/>
<datalist id="modele-list-pressostat"></datalist>
<td>
<div class="dropzone" id="pressostat-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="pressostat-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>REGULATION ECS</td>
<td>
<input class="marque-input" list="marque-list-regulation-ecs" type="text"/>
<datalist id="marque-list-regulation-ecs"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-regulation-ecs" type="text"/>
<datalist id="modele-list-regulation-ecs"></datalist>
<td>
<div class="dropzone" id="regulation-ecs-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="regulation-ecs-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>REGULATION VIESSMANN</td>
<td>
<input class="marque-input" list="marque-list-regulation-viessmann" type="text"/>
<datalist id="marque-list-regulation-viessmann"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-regulation-viessmann" type="text"/>
<datalist id="modele-list-regulation-viessmann"></datalist>
<td>
<div class="dropzone" id="regulation-viessmann-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="regulation-viessmann-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>SERVOMOTEUR CHAUFFAGE</td>
<td>
<input class="marque-input" list="marque-list-servomoteur-chauffage" type="text"/>
<datalist id="marque-list-servomoteur-chauffage"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-servomoteur-chauffage" type="text"/>
<datalist id="modele-list-servomoteur-chauffage"></datalist>
<td>
<div class="dropzone" id="servomoteur-chauffage-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="servomoteur-chauffage-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>SERVOMOTEUR ECS</td>
<td>
<input class="marque-input" list="marque-list-servomoteur-ecs" type="text"/>
<datalist id="marque-list-servomoteur-ecs"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-servomoteur-ecs" type="text"/>
<datalist id="modele-list-servomoteur-ecs"></datalist>
<td>
<div class="dropzone" id="servomoteur-ecs-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="servomoteur-ecs-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>SOUPAPE DE SECURITE</td>
<td>
<input class="marque-input" list="marque-list-soupape-securite" type="text"/>
<datalist id="marque-list-soupape-securite"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-soupape-securite" type="text"/>
<datalist id="modele-list-soupape-securite"></datalist>
<td>
<div class="dropzone" id="soupape-securite-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="soupape-securite-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>TRAITEMENT FILMOGENE</td>
<td>
<input class="marque-input" list="marque-list-traitement" type="text"/>
<datalist id="marque-list-traitement"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-traitement" type="text"/>
<datalist id="modele-list-traitement"></datalist>
<td>
<div class="dropzone" id="traitement-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="traitement-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>VANNE DEUX VOIES MOTORISEE</td>
<td>
<input class="marque-input" list="marque-list-vanne-deux" type="text"/>
<datalist id="marque-list-vanne-deux"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-vanne-deux" type="text"/>
<datalist id="modele-list-vanne-deux"></datalist>
<td>
<div class="dropzone" id="vanne-deux-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="vanne-deux-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>VANNE TROIS VOIES CHAUFFAGE</td>
<td>
<input class="marque-input" list="marque-list-vanne-trois-chauffage" type="text"/>
<datalist id="marque-list-vanne-trois-chauffage"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-vanne-trois-chauffage" type="text"/>
<datalist id="modele-list-vanne-trois-chauffage"></datalist>
<td>
<div class="dropzone" id="vanne-trois-chauffage-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="vanne-trois-chauffage-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>VANNE TROIS VOIES ECS</td>
<td>
<input class="marque-input" list="marque-list-vanne-trois-ecs" type="text"/>
<datalist id="marque-list-vanne-trois-ecs"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-vanne-trois-ecs" type="text"/>
<datalist id="modele-list-vanne-trois-ecs"></datalist>
<td>
<div class="dropzone" id="vanne-trois-ecs-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="vanne-trois-ecs-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>VASE D'EXPANSION CHAUFFAGE</td>
<td>
<input class="marque-input" list="marque-list-vase-chauffage" type="text"/>
<datalist id="marque-list-vase-chauffage"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-vase-chauffage" type="text"/>
<datalist id="modele-list-vase-chauffage"></datalist>
<td>
<div class="dropzone" id="vase-chauffage-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="vase-chauffage-file" type="file"/>

</td>
</td></tr>
<tr class="fiches-techniques-row">
<td>VASE D'EXPANSION SANITAIRE</td>
<td>
<input class="marque-input" list="marque-list-vase-sanitaire" type="text"/>
<datalist id="marque-list-vase-sanitaire"></datalist>
</td>
<td>
<input class="modele-input" list="modele-list-vase-sanitaire" type="text"/>
<datalist id="modele-list-vase-sanitaire"></datalist>
<td>
<div class="dropzone" id="vase-sanitaire-dropzone">Cliquez ou déposez</div>
<input accept="application/pdf" class="file-upload" id="vase-sanitaire-file" type="file"/>

</td>
</td></tr>
</tbody>
</table>
<!-- Proces Verbaux Table -->
<hr/>
<h2 class="h-pv">PROCES VERBAUX</h2>
<table>
<thead>
<tr>
<th class="pv-1">DESCRIPTION</th>
<th class="pv-2">FICHIER</th>
</tr>
</thead>
<tbody>
<tr class="proces-verbaux-row">
<td>CERTIFICAT DE DECHARGE D'AMIANTE</td>
<td>
<div class="dropzone" id="certificat-amiantedropzone">Cliquez ou déposez</div>
<input id="certificat-amiante-file" type="file"/>
</td>
</tr>
<tr class="proces-verbaux-row">
<td>DEGAZAGE CUVE FIOUL</td>
<td>
<div class="dropzone" id="degazage-cuvedropzone">Cliquez ou déposez</div>
<input id="degazage-cuve-file" type="file"/>
</td>
</tr>
<tr class="proces-verbaux-row">
<td>DETECTION GAZ</td>
<td>
<div class="dropzone" id="detection-gazdropzone">Cliquez ou déposez</div>
<input id="detection-gaz-file" type="file"/>
</td>
</tr>
<tr class="proces-verbaux-row">
<td>FLOCAGE</td>
<td>
<div class="dropzone" id="flocage-dropzone">Cliquez ou déposez</div>
<input id="flocage-file" type="file"/>
</td>
</tr>
<tr class="proces-verbaux-row">
<td>MESURE ACOUSTIQUE</td>
<td>
<div class="dropzone" id="mesure-acoustique-dropzone">Cliquez ou déposez</div>
<input id="mesure-acoustique-file" type="file"/>
</td>
</tr>
<tr class="proces-verbaux-row">
<td>MISE EN SERVICE ADOUCISSEUR</td>
<td>
<div class="dropzone" id="service-adoucisseur-dropzone">Cliquez ou déposez</div>
<input id="service-adoucisseur-file" type="file"/>
</td>
</tr>
<tr class="proces-verbaux-row">
<td>MISE EN SERVICE CHAUDIERE</td>
<td>
<div class="dropzone" id="service-chaudiere-dropzone">Cliquez ou déposez</div>
<input id="service-chaudiere-file" type="file"/>
</td>
</tr>
<tr class="proces-verbaux-row">
<td>MISE EN SERVICE FILMOGENE</td>
<td>
<div class="dropzone" id="service-filmogene-dropzone">Cliquez ou déposez</div>
<input id="service-filmogene-file" type="file"/>
</td>
</tr>
<tr class="proces-verbaux-row">
<td>MISE EN SERVICE OLDHAM</td>
<td>
<div class="dropzone" id="service-oldham-dropzone">Cliquez ou déposez</div>
<input id="service-oldham-file" type="file"/>
</td>
</tr>
<tr class="proces-verbaux-row">
<td>MISE EN SERVICE REFLEX</td>
<td>
<div class="dropzone" id="service-reflex-dropzone">Cliquez ou déposez</div>
<input id="service-reflex-file" type="file"/>
</td>
</tr>
<tr class="proces-verbaux-row">
<td>PORTE</td>
<td>
<div class="dropzone" id="porte-dropzone">Cliquez ou déposez</div>
<input id="porte-file" type="file"/>
</td>
</tr>
<tr class="proces-verbaux-row">
<td>QUALIGAZ</td>
<td>
<div class="dropzone" id="qualigaz-dropzone">Cliquez ou déposez</div>
<input id="qualigaz-file" type="file"/>
</td>
</tr>
<tr class="proces-verbaux-row">
<td>RAPPORT DESEMBOUAGE</td>
<td>
<div class="dropzone" id="rapport-desembouage-dropzone">Cliquez ou déposez</div>
<input id="rapport-desembouage-file" type="file"/>
</td>
</tr>
<tr class="proces-verbaux-row">
<td>TUBAGE</td>
<td>
<div class="dropzone" id="tubage-dropzone">Cliquez ou déposez</div>
<input id="tubage-file" type="file"/>
</td>
</tr>
</tbody>
</table>
<!-- Schemas Table -->
<hr/>
<h2 class="h-sch">SCHEMAS</h2>
<table>
<thead>
<tr>
<th class="sch-1">DESCRIPTION</th>
<th class="sch-2">FICHIER</th>
</tr>
</thead>
<tbody>
<tr class="schemas-row">
<td>SCHEMA HYDRAULIQUE</td>
<td>
<div class="dropzone" id="schema-hydraulique-dropzone">Cliquez ou déposez</div>
<input id="schema-hydraulique-file" type="file"/>
</td>
</tr>
<tr class="schemas-row">
<td>SCHEMA ELECTRIQUE</td>
<td>
<div class="dropzone" id="schema-electrique-dropzone">Cliquez ou déposez</div>
<input id="schema-electrique-file" type="file"/>
</td>
</tr>
<tr class="schemas-row">
<td>EQUILIBRAGE</td>
<td>
<div class="dropzone" id="equilibrage-dropzone">Cliquez ou déposez</div>
<input id="equilibrage-file" type="file"/>
</td>
</tr>
</tbody>
</table>
<div style="
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: 10px;
">
    <div class="loader" style="display: none;"></div>

    <div style="display: flex; gap: 5px; width: 60%">
        <button type="button" id="save-progress" class="save-btn">ENREGISTRER</button>
        <button type="button" id="load-progress" class="load-btn">CHARGER</button>
    </div>
	
    <button type="submit" class="primary-btn">CREER ET TELECHARGER</button>
	
</div>

<script>
			// Postal Code to City Data
			const postalCodeToCity = {
			    "75001": ["PARIS"],
			    "75002": ["PARIS"],
			    "75003": ["PARIS"],
			    "75004": ["PARIS"],
			    "75005": ["PARIS"],
			    "75006": ["PARIS"],
			    "75007": ["PARIS"],
			    "75008": ["PARIS"],
			    "75009": ["PARIS"],
			    "75010": ["PARIS"],
			    "75011": ["PARIS"],
			    "75012": ["PARIS"],
			    "75013": ["PARIS"],
			    "75014": ["PARIS"],
			    "75015": ["PARIS"],
			    "75016": ["PARIS"],
			    "75116": ["PARIS"],
			    "75017": ["PARIS"],
			    "75018": ["PARIS"],
			    "75019": ["PARIS"],
			    "75020": ["PARIS"],
			    "77760": ["ACHERES LA FORET"],
			    "77120": ["AMILLIS"],
			    "77760": ["AMPONVILLE"],
			    "77390": ["ANDREZEL"],
			    "77410": ["ANNET SUR MARNE"],
			    "77630": ["ARBONNE LA FORET"],
			    "77390": ["ARGENTIERES"],
			    "77440": ["ARMENTIERES EN BRIE"],
			    "77890": ["ARVILLE"],
			    "77720": ["AUBEPIERRE OZOUER LE REPOS"],
			    "77570": ["AUFFERVILLE"],
			    "77560": ["AUGERS EN BRIE"],
			    "77120": ["AULNOY"],
			    "77210": ["AVON"],
			    "77480": ["BABY"],
			    "77167": ["BAGNEAUX SUR LOING"],
			    "77700": ["BAILLY ROMAINVILLIERS"],
			    "77118": ["BALLOY"],
			    "77970": ["BANNOST VILLEGAGNON"],
			    "77130": ["BARBEY"],
			    "77630": ["BARBIZON"],
			    "77910": ["BARCY"],
			    "77750": ["BASSEVELLE"],
			    "77118": ["BAZOCHES LES BRAY"],
			    "77560": ["BEAUCHERY ST MARTIN"],
			    "77890": ["BEAUMONT DU GATINAIS"],
			    "77390": ["BEAUVOIR"],
			    "77510": ["BELLOT"],
			    "77540": ["BERNAY VILBERT"],
			    "77320": ["BETON BAZOCHES"],
			    "77970": ["BEZALLES"],
			    "77115": ["BLANDY"],
			    "77940": ["BLENNES"],
			    "77970": ["BOISDON"],
			    "77590": ["BOIS LE ROI"],
			    "77350": ["BOISSETTES"],
			    "77350": ["BOISSISE LA BERTRAND"],
			    "77310": ["BOISSISE LE ROI"],
			    "77760": ["BOISSY AUX CAILLES"],
			    "77169": ["BOISSY LE CHATEL"],
			    "77750": ["BOITRON"],
			    "77720": ["BOMBON"],
			    "77570": ["BOUGLIGNY"],
			    "77760": ["BOULANCOURT"],
			    "77580": ["BOULEURS"],
			    "77780": ["BOURRON MARLOTTE"],
			    "77470": ["BOUTIGNY"],
			    "77620": ["BRANSLES"],
			    "77480": ["BRAY SUR SEINE"],
			    "77720": ["BREAU"],
			    "77170": ["BRIE COMTE ROBERT"],
			    "77940": ["LA BROSSE MONTCEAUX"],
			    "77177": ["BROU SUR CHANTEREINE"],
			    "77760": ["BURCY"],
			    "77750": ["BUSSIERES"],
			    "77600": ["BUSSY ST GEORGES"],
			    "77600": ["BUSSY ST MARTIN"],
			    "77760": ["BUTHIERS"],
			    "77130": ["CANNES ECLUSE"],
			    "77400": ["CARNETIN"],
			    "77515": ["LA CELLE SUR MORIN"],
			    "77930": ["CELY"],
			    "77320": ["CERNEUX"],
			    "77240": ["CESSON"],
			    "77520": ["CESSOY EN MONTOIS"],
			    "77930": ["CHAILLY EN BIERE"],
			    "77120": ["CHAILLY EN BRIE"],
			    "77460": ["CHAINTREAUX"],
			    "77171": ["CHALAUTRE LA GRANDE"],
			    "77160": ["CHALAUTRE LA PETITE"],
			    "77144": ["CHALIFERT"],
			    "77650": ["CHALMAISON"],
			    "77910": ["CHAMBRY"],
			    "77260": ["CHAMIGNY"],
			    "77430": ["CHAMPAGNE SUR SEINE"],
			    "77560": ["CHAMPCENEST"],
			    "77390": ["CHAMPDEUIL"],
			    "77720": ["CHAMPEAUX"],
			    "77420": ["CHAMPS SUR MARNE"],
			    "77660": ["CHANGIS SUR MARNE"],
			    "77600": ["CHANTELOUP EN BRIE"],
			    "77720": ["LA CHAPELLE GAUTHIER"],
			    "77540": ["LA CHAPELLE IGER"],
			    "77760": ["LA CHAPELLE LA REINE"],
			    "77370": ["LA CHAPELLE RABLAIS"],
			    "77160": ["LA CHAPELLE ST SULPICE"],
			    "77610": ["LES CHAPELLES BOURBON"],
			    "77320": ["LA CHAPELLE MOUTILS"],
			    "77410": ["CHARMENTRAY"],
			    "77410": ["CHARNY"],
			    "77590": ["CHARTRETTES"],
			    "77320": ["CHARTRONGES"],
			    "77370": ["CHATEAUBLEAU"],
			    "77570": ["CHATEAU LANDON"],
			    "77820": ["LE CHATELET EN BRIE"],
			    "77126": ["CHATENAY SUR SEINE"],
			    "77167": ["CHATENOY"],
			    "77820": ["CHATILLON LA BORDE"],
			    "77610": ["CHATRES"],
			    "77169": ["CHAUFFRY"],
			    "77390": ["CHAUMES EN BRIE"],
			    "77500": ["CHELLES"],
			    "77160": ["CHENOISE CUCHARMOY"],
			    "77570": ["CHENOU"],
			    "77700": ["CHESSY"],
			    "77760": ["CHEVRAINVILLIERS"],
			    "77320": ["CHEVRU"],
			    "77173": ["CHEVRY COSSIGNY"],
			    "77710": ["CHEVRY EN SEREINE"],
			    "77320": ["CHOISY EN BRIE"],
			    "77730": ["CITRY"],
			    "77410": ["CLAYE SOUILLY"],
			    "77370": ["CLOS FONTAINE"],
			    "77440": ["COCHEREL"],
			    "77090": ["COLLEGIEN"],
			    "77380": ["COMBS LA VILLE"],
			    "77290": ["COMPANS"],
			    "77600": ["CONCHES SUR GONDOIRE"],
			    "77450": ["CONDE STE LIBIAIRE"],
			    "77440": ["CONGIS SUR THEROUANNE"],
			    "77170": ["COUBERT"],
			    "77860": ["COUILLY PONT AUX DAMES"],
			    "77840": ["COULOMBS EN VALOIS"],
			    "77580": ["COULOMMES"],
			    "77120": ["COULOMMIERS"],
			    "77700": ["COUPVRAY"],
			    "77126": ["COURCELLES EN BASSEE"],
			    "77560": ["COURCHAMP"],
			    "77540": ["COURPALAY"],
			    "77390": ["COURQUETAINE"],
			    "77560": ["COURTACON"],
			    "77390": ["COURTOMER"],
			    "77181": ["COURTRY"],
			    "77154": ["COUTENCON"],
			    "77580": ["COUTEVROULT"],
			    "77580": ["CRECY LA CHAPELLE"],
			    "77124": ["CREGY LES MEAUX"],
			    "77610": ["CREVECOEUR EN BRIE"],
			    "77390": ["CRISENOY"],
			    "77183": ["CROISSY BEAUBOURG"],
			    "77370": ["LA CROIX EN BRIE"],
			    "77840": ["CROUY SUR OURCQ"],
			    "77165": ["CUISY"],
			    "77320": ["DAGNY"],
			    "77190": ["DAMMARIE LES LYS"],
			    "77230": ["DAMMARTIN EN GOELE"],
			    "77163": ["DAMMARTIN SUR TIGEAUX"],
			    "77400": ["DAMPMART"],
			    "77140": ["DARVAULT"],
			    "77440": ["DHUISY"],
			    "77940": ["DIANT"],
			    "77520": ["DONNEMARIE DONTILLY"],
			    "77130": ["DORMELLES"],
			    "77510": ["DOUE"],
			    "77139": ["DOUY LA RAMEE"],
			    "77830": ["ECHOUBOULAINS"],
			    "77820": ["LES ECRENNES"],
			    "77126": ["EGLIGNY"],
			    "77620": ["EGREVILLE"],
			    "77184": ["EMERAINVILLE"],
			    "77450": ["ESBLY"],
			    "77940": ["ESMANS"],
			    "77139": ["ETREPILLY"],
			    "77157": ["EVERLY"],
			    "77166": ["EVRY GREGY SUR YERRE"],
			    "77515": ["FAREMOUTIERS"],
			    "77220": ["FAVIERES"],
			    "77167": ["FAY LES NEMOURS"],
			    "77133": ["FERICY"],
			    "77150": ["FEROLLES ATTILLY"],
			    "77164": ["FERRIERES EN BRIE"],
			    "77320": ["LA FERTE GAUCHER"],
			    "77260": ["LA FERTE SOUS JOUARRE"],
			    "77940": ["FLAGY"],
			    "77930": ["FLEURY EN BIERE"],
			    "77300": ["FONTAINEBLEAU"],
			    "77480": ["FONTAINE FOURCHES"],
			    "77590": ["FONTAINE LE PORT"],
			    "77370": ["FONTAINS"],
			    "77370": ["FONTENAILLES"],
			    "77610": ["FONTENAY TRESIGNY"],
			    "77165": ["FORFRY"],
			    "77130": ["FORGES"],
			    "77390": ["FOUJU"],
			    "77410": ["FRESNES SUR MARNE"],
			    "77320": ["FRETOY"],
			    "77760": ["FROMONT"],
			    "77470": ["FUBLAINES"],
			    "77890": ["GARENTREVILLE"],
			    "77370": ["GASTINS"],
			    "77690": ["LA GENEVRAYE"],
			    "77910": ["GERMIGNY L EVEQUE"],
			    "77840": ["GERMIGNY SOUS COULOMBS"],
			    "77165": ["GESVRES LE CHAPITRE"],
			    "77120": ["GIREMOUTIERS"],
			    "77890": ["GIRONVILLE"],
			    "77114": ["GOUAIX"],
			    "77400": ["GOUVERNES"],
			    "77130": ["LA GRANDE PAROISSE"],
			    "77720": ["GRANDPUITS BAILLY CARROIS"],
			    "77118": ["GRAVON"],
			    "77410": ["GRESSY"],
			    "77220": ["GRETZ ARMAINVILLIERS"],
			    "77880": ["GREZ SUR LOING"],
			    "77166": ["GRISY SUISNES"],
			    "77480": ["GRISY SUR SEINE"],
			    "77580": ["GUERARD"],
			    "77760": ["GUERCHEVILLE"],
			    "77600": ["GUERMANTES"],
			    "77390": ["GUIGNES"],
			    "77520": ["GURCY LE CHATEL"],
			    "77515": ["HAUTEFEUILLE"],
			    "77580": ["LA HAUTE MAISON"],
			    "77850": ["HERICY"],
			    "77114": ["HERME"],
			    "77510": ["HONDEVILLIERS"],
			    "77610": ["LA HOUSSAYE EN BRIE"],
			    "77890": ["ICHY"],
			    "77440": ["ISLES LES MELDEUSES"],
			    "77450": ["ISLES LES VILLENOY"],
			    "77165": ["IVERNY"],
			    "77450": ["JABLINES"],
			    "77440": ["JAIGNES"],
			    "77480": ["JAULNES"],
			    "77600": ["JOSSIGNY"],
			    "77640": ["JOUARRE"],
			    "77970": ["JOUY LE CHATEL"],
			    "77320": ["JOUY SUR MORIN"],
			    "77230": ["JUILLY"],
			    "77650": ["JUTIGNY"],
			    "77400": ["LAGNY SUR MARNE"],
			    "77760": ["LARCHANT"],
			    "77148": ["LAVAL EN BRIE"],
			    "77171": ["LECHELLE"],
			    "77320": ["LESCHEROLLES"],
			    "77450": ["LESCHES"],
			    "77150": ["LESIGNY"],
			    "77320": ["LEUDON EN BRIE"],
			    "77127": ["LIEUSAINT"],
			    "77550": ["LIMOGES FOURCHES"],
			    "77550": ["LISSY"],
			    "77220": ["LIVERDY EN BRIE"],
			    "77000": ["LIVRY SUR SEINE"],
			    "77650": ["LIZINES"],
			    "77440": ["LIZY SUR OURCQ"],
			    "77185": ["LOGNES"],
			    "77230": ["LONGPERRIER"],
			    "77650": ["LONGUEVILLE"],
			    "77710": ["LORREZ LE BOCAGE PREAUX"],
			    "77560": ["LOUAN VILLEGRUIS FONTAINE"],
			    "77520": ["LUISETAINES"],
			    "77540": ["LUMIGNY NESLES ORMEAUX"],
			    "77138": ["LUZANCY"],
			    "77133": ["MACHAULT"],
			    "77570": ["LA MADELEINE SUR LOING"],
			    "77700": ["MAGNY LE HONGRE"],
			    "77950": ["MAINCY"],
			    "77580": ["MAISONCELLES EN BRIE"],
			    "77570": ["MAISONCELLES EN GATINAIS"],
			    "77370": ["MAISON ROUGE"],
			    "77230": ["MARCHEMORET"],
			    "77139": ["MARCILLY"],
			    "77560": ["LES MARETS"],
			    "77100": ["MAREUIL LES MEAUX"],
			    "77610": ["MARLES EN BRIE"],
			    "77120": ["MAROLLES EN BRIE"],
			    "77130": ["MAROLLES SUR SEINE"],
			    "77440": ["MARY SUR MARNE"],
			    "77120": ["MAUPERTHUIS"],
			    "77990": ["MAUREGARD"],
			    "77145": ["MAY EN MULTIEN"],
			    "77100": ["MEAUX"],
			    "77350": ["LE MEE SUR SEINE"],
			    "77520": ["MEIGNEUX"],
			    "77320": ["MEILLERAY"],
			    "77000": ["MELUN"],
			    "77171": ["MELZ SUR SEINE"],
			    "77730": ["MERY SUR MARNE"],
			    "77990": ["LE MESNIL AMELOT"],
			    "77410": ["MESSY"],
			    "77130": ["MISY SUR YONNE"],
			    "77290": ["MITRY MORY"],
			    "77950": ["MOISENAY"],
			    "77550": ["MOISSY CRAMAYEL"],
			    "77570": ["MONDREVILLE"],
			    "77520": ["MONS EN MONTOIS"],
			    "77470": ["MONTCEAUX LES MEAUX"],
			    "77151": ["MONTCEAUX LES PROVINS"],
			    "77140": ["MONTCOURT FROMONVILLE"],
			    "77320": ["MONTDAUPHIN"],
			    "77320": ["MONTENILS"],
			    "77130": ["MONTEREAU FAULT YONNE"],
			    "77950": ["MONTEREAU SUR LE JARD"],
			    "77144": ["MONTEVRAIN"],
			    "77230": ["MONTGE EN GOELE"],
			    "77122": ["MONTHYON"],
			    "77480": ["MONTIGNY LE GUESDIER"],
			    "77520": ["MONTIGNY LENCOUP"],
			    "77690": ["MONTIGNY SUR LOING"],
			    "77940": ["MONTMACHOUX"],
			    "77320": ["MONTOLIVET"],
			    "77450": ["MONTRY"],
			    "77250": ["MORET LOING ET ORVANNE"],
			    "77720": ["MORMANT"],
			    "77163": ["MORTCERF"],
			    "77160": ["MORTERY"],
			    "77120": ["MOUROUX"],
			    "77480": ["MOUSSEAUX LES BRAY"],
			    "77230": ["MOUSSY LE NEUF"],
			    "77230": ["MOUSSY LE VIEUX"],
			    "77480": ["MOUY SUR SEINE"],
			    "77176": ["NANDY"],
			    "77370": ["NANGIS"],
			    "77760": ["NANTEAU SUR ESSONNE"],
			    "77710": ["NANTEAU SUR LUNAIN"],
			    "77100": ["NANTEUIL LES MEAUX"],
			    "77730": ["NANTEUIL SUR MARNE"],
			    "77230": ["NANTOUILLET"],
			    "77140": ["NEMOURS"],
			    "77124": ["CHAUCONIN NEUFMONTIERS"],
			    "77610": ["NEUFMOUTIERS EN BRIE"],
			    "77186": ["NOISIEL"],
			    "77940": ["NOISY RUDIGNON"],
			    "77123": ["NOISY SUR ECOLE"],
			    "77140": ["NONVILLE"],
			    "77114": ["NOYEN SUR SEINE"],
			    "77890": ["OBSONVILLE"],
			    "77440": ["OCQUERRE"],
			    "77178": ["OISSERY"],
			    "77750": ["ORLY SUR MORIN"],
			    "77134": ["LES ORMES SUR VOULZIE"],
			    "77167": ["ORMESSON"],
			    "77280": ["OTHIS"],
			    "77330": ["OZOIR LA FERRIERE"],
			    "77390": ["OZOUER LE VOULGIS"],
			    "77710": ["PALEY"],
			    "77830": ["PAMFOU"],
			    "77520": ["PAROY"],
			    "77480": ["PASSY SUR SEINE"],
			    "77970": ["PECY"],
			    "77124": ["PENCHARD"],
			    "77930": ["PERTHES"],
			    "77131": ["PEZARCHES"],
			    "77580": ["PIERRE LEVEE"],
			    "77181": ["LE PIN"],
			    "77165": ["LE PLESSIS AUX BOIS"],
			    "77540": ["LE PLESSIS FEU AUSSOUX"],
			    "77165": ["LE PLESSIS L EVEQUE"],
			    "77440": ["LE PLESSIS PLACY"],
			    "77160": ["POIGNY"],
			    "77470": ["POINCY"],
			    "77167": ["POLIGNY"],
			    "77515": ["POMMEUSE"],
			    "77400": ["POMPONNE"],
			    "77340": ["PONTAULT COMBAULT"],
			    "77135": ["PONTCARRE"],
			    "77410": ["PRECY SUR MARNE"],
			    "77220": ["PRESLES EN BRIE"],
			    "77310": ["PRINGY"],
			    "77160": ["PROVINS"],
			    "77139": ["PUISIEUX"],
			    "77720": ["QUIERS"],
			    "77860": ["QUINCY VOISINS"],
			    "77370": ["RAMPILLON"],
			    "77550": ["REAU"],
			    "77510": ["REBAIS"],
			    "77760": ["RECLOSES"],
			    "77710": ["REMAUVILLE"],
			    "77260": ["REUIL EN BRIE"],
			    "77000": ["LA ROCHETTE"],
			    "77680": ["ROISSY EN BRIE"],
			    "77160": ["ROUILLY"],
			    "77230": ["ROUVRES"],
			    "77540": ["ROZAY EN BRIE"],
			    "77950": ["RUBELLES"],
			    "77760": ["RUMONT"],
			    "77560": ["RUPEREUX"],
			    "77730": ["SAACY SUR MARNE"],
			    "77510": ["SABLONNIERES"],
			    "77515": ["ST AUGUSTIN"],
			    "77260": ["STE AULDE"],
			    "77320": ["ST BARTHELEMY"],
			    "77160": ["ST BRICE"],
			    "77650": ["STE COLOMBE"],
			    "77750": ["ST CYR SUR MORIN"],
			    "77510": ["ST DENIS LES REBAIS"],
			    "77310": ["ST FARGEAU PONTHIERRY"],
			    "77470": ["ST FIACRE"],
			    "77130": ["ST GERMAIN LAVAL"],
			    "77950": ["ST GERMAIN LAXIS"],
			    "77169": ["ST GERMAIN SOUS DOUE"],
			    "77930": ["ST GERMAIN SUR ECOLE"],
			    "77860": ["ST GERMAIN SUR MORIN"],
			    "77160": ["ST HILLIERS"],
			    "77660": ["ST JEAN LES DEUX JUMEAUX"],
			    "77370": ["ST JUST EN BRIE"],
			    "77510": ["ST LEGER"],
			    "77650": ["ST LOUP DE NAUD"],
			    "77670": ["ST MAMMES"],
			    "77230": ["ST MARD"],
			    "77320": ["ST MARS VIEUX MAISONS"],
			    "77320": ["ST MARTIN DES CHAMPS"],
			    "77320": ["ST MARTIN DU BOSCHET"],
			    "77630": ["ST MARTIN EN BIERE"],
			    "77720": ["ST MERY"],
			    "77410": ["ST MESMES"],
			    "77720": ["ST OUEN EN BRIE"],
			    "77750": ["ST OUEN SUR MORIN"],
			    "77178": ["ST PATHUS"],
			    "77140": ["ST PIERRE LES NEMOURS"],
			    "77320": ["ST REMY DE LA VANNE"],
			    "77120": ["BEAUTHEIL SAINTS"],
			    "77480": ["ST SAUVEUR LES BRAY"],
			    "77930": ["ST SAUVEUR SUR ECOLE"],
			    "77169": ["ST SIMEON"],
			    "77165": ["ST SOUPPLETS"],
			    "77400": ["ST THIBAULT DES VIGNES"],
			    "77148": ["SALINS"],
			    "77260": ["SAMMERON"],
			    "77920": ["SAMOIS SUR SEINE"],
			    "77210": ["SAMOREAU"],
			    "77580": ["SANCY"],
			    "77320": ["SANCY LES PROVINS"],
			    "77176": ["SAVIGNY LE TEMPLE"],
			    "77650": ["SAVINS"],
			    "77240": ["SEINE PORT"],
			    "77260": ["SEPT SORTS"],
			    "77700": ["SERRIS"],
			    "77170": ["SERVON"],
			    "77640": ["SIGNY SIGNETS"],
			    "77520": ["SIGY"],
			    "77115": ["SIVRY COURTRY"],
			    "77520": ["SOGNOLLES EN MONTOIS"],
			    "77111": ["SOIGNOLLES EN BRIE"],
			    "77650": ["SOISY BOUY"],
			    "77111": ["SOLERS"],
			    "77460": ["SOUPPES SUR LOING"],
			    "77171": ["SOURDUN"],
			    "77440": ["TANCROU"],
			    "77520": ["THENISY"],
			    "77230": ["THIEUX"],
			    "77810": ["THOMERY"],
			    "77400": ["THORIGNY SUR MARNE"],
			    "77940": ["THOURY FEROTTES"],
			    "77163": ["TIGEAUX"],
			    "77130": ["LA TOMBE"],
			    "77200": ["TORCY"],
			    "77131": ["TOUQUIN"],
			    "77220": ["TOURNAN EN BRIE"],
			    "77123": ["TOUSSON"],
			    "77510": ["LA TRETOIRE"],
			    "77710": ["TREUZY LEVELAY"],
			    "77450": ["TRILBARDOU"],
			    "77470": ["TRILPORT"],
			    "77440": ["TROCY EN MULTIEN"],
			    "77760": ["URY"],
			    "77260": ["USSY SUR MARNE"],
			    "77360": ["VAIRES SUR MARNE"],
			    "77830": ["VALENCE EN BRIE"],
			    "77370": ["VANVILLE"],
			    "77130": ["VARENNES SUR SEINE"],
			    "77910": ["VARREDDES"],
			    "77580": ["VAUCOURTOIS"],
			    "77123": ["LE VAUDOUE"],
			    "77141": ["VAUDOY EN BRIE"],
			    "77000": ["VAUX LE PENIL"],
			    "77710": ["VAUX SUR LUNAIN"],
			    "77440": ["VENDREST"],
			    "77510": ["VERDELOT"],
			    "77390": ["VERNEUIL L ETANG"],
			    "77670": ["VERNOU LA CELLE SUR SEINE"],
			    "77240": ["VERT ST DENIS"],
			    "77370": ["VIEUX CHAMPAGNE"],
			    "77450": ["VIGNELY"],
			    "77710": ["VILLEBEON"],
			    "77250": ["VILLECERF"],
			    "77710": ["VILLEMARECHAL"],
			    "77470": ["VILLEMAREUIL"],
			    "77250": ["VILLEMER"],
			    "77480": ["VILLENAUXE LA PETITE"],
			    "77174": ["VILLENEUVE LE COMTE"],
			    "77154": ["VILLENEUVE LES BORDES"],
			    "77174": ["VILLENEUVE ST DENIS"],
			    "77230": ["VILLENEUVE SOUS DAMMARTIN"],
			    "77510": ["VILLENEUVE SUR BELLOT"],
			    "77124": ["VILLENOY"],
			    "77270": ["VILLEPARISIS"],
			    "77410": ["VILLEROY"],
			    "77130": ["VILLE ST JACQUES"],
			    "77410": ["VILLEVAUDE"],
			    "77190": ["VILLIERS EN BIERE"],
			    "77560": ["VILLIERS ST GEORGES"],
			    "77760": ["VILLIERS SOUS GREZ"],
			    "77580": ["VILLIERS SUR MORIN"],
			    "77114": ["VILLIERS SUR SEINE"],
			    "77480": ["VILLUIS"],
			    "77520": ["VIMPELLES"],
			    "77230": ["VINANTES"],
			    "77139": ["VINCY MANOEUVRE"],
			    "77540": ["VOINSLES"],
			    "77950": ["VOISENON"],
			    "77580": ["VOULANGIS"],
			    "77560": ["VOULTON"],
			    "77940": ["VOULX"],
			    "77160": ["VULAINES LES PROVINS"],
			    "77870": ["VULAINES SUR SEINE"],
			    "77390": ["YEBLES"],
			    "78660": ["ABLIS"],
			    "78260": ["ACHERES"],
			    "78113": ["ADAINVILLE"],
			    "78240": ["AIGREMONT"],
			    "78660": ["ALLAINVILLE"],
			    "78580": ["LES ALLUETS LE ROI"],
			    "78770": ["ANDELU"],
			    "78570": ["ANDRESY"],
			    "78790": ["ARNOUVILLE LES MANTES"],
			    "78410": ["AUBERGENVILLE"],
			    "78610": ["AUFFARGIS"],
			    "78930": ["AUFFREVILLE BRASSEUIL"],
			    "78126": ["AULNAY SUR MAULDRE"],
			    "78770": ["AUTEUIL"],
			    "78770": ["AUTOUILLET"],
			    "78870": ["BAILLY"],
			    "78550": ["BAZAINVILLE"],
			    "78580": ["BAZEMONT"],
			    "78490": ["BAZOCHES SUR GUYONNE"],
			    "78910": ["BEHOUST"],
			    "78270": ["BENNECOURT"],
			    "78650": ["BEYNES"],
			    "78270": ["BLARU"],
			    "78930": ["BOINVILLE EN MANTOIS"],
			    "78660": ["BOINVILLE LE GAILLARD"],
			    "78200": ["BOINVILLIERS"],
			    "78390": ["BOIS D ARCY"],
			    "78910": ["BOISSETS"],
			    "78125": ["LA BOISSIERE ECOLE"],
			    "78200": ["BOISSY MAUVOISIN"],
			    "78490": ["BOISSY SANS AVOIR"],
			    "78830": ["BONNELLES"],
			    "78270": ["BONNIERES SUR SEINE"],
			    "78410": ["BOUAFLE"],
			    "78380": ["BOUGIVAL"],
			    "78113": ["BOURDONNE"],
			    "78930": ["BREUIL BOIS ROBERT"],
			    "78980": ["BREVAL"],
			    "78610": ["LES BREVIAIRES"],
			    "78440": ["BRUEIL EN VEXIN"],
			    "78530": ["BUC"],
			    "78200": ["BUCHELAY"],
			    "78830": ["BULLION"],
			    "78955": ["CARRIERES SOUS POISSY"],
			    "78420": ["CARRIERES SUR SEINE"],
			    "78720": ["LA CELLE LES BORDES"],
			    "78170": ["LA CELLE ST CLOUD"],
			    "78720": ["CERNAY LA VILLE"],
			    "78240": ["CHAMBOURCY"],
			    "78570": ["CHANTELOUP LES VIGNES"],
			    "78130": ["CHAPET"],
			    "78117": ["CHATEAUFORT"],
			    "78400": ["CHATOU"],
			    "78270": ["CHAUFOUR LES BONNIERES"],
			    "78450": ["CHAVENAY"],
			    "78150": ["LE CHESNAY ROCQUENCOURT"],
			    "78460": ["CHEVREUSE"],
			    "78460": ["CHOISEL"],
			    "78910": ["CIVRY LA FORET"],
			    "78120": ["CLAIREFONTAINE EN YVELINES"],
			    "78340": ["LES CLAYES SOUS BOIS"],
			    "78310": ["COIGNIERES"],
			    "78113": ["CONDE SUR VESGRE"],
			    "78700": ["CONFLANS STE HONORINE"],
			    "78790": ["COURGENT"],
			    "78270": ["CRAVENT"],
			    "78121": ["CRESPIERES"],
			    "78290": ["CROISSY SUR SEINE"],
			    "78111": ["DAMMARTIN EN SERVE"],
			    "78720": ["DAMPIERRE EN YVELINES"],
			    "78550": ["DANNEMARIE"],
			    "78810": ["DAVRON"],
			    "78440": ["DROCOURT"],
			    "78920": ["ECQUEVILLY"],
			    "78990": ["ELANCOURT"],
			    "78125": ["EMANCE"],
			    "78680": ["EPONE"],
			    "78690": ["LES ESSARTS LE ROI"],
			    "78620": ["L ETANG LA VILLE"],
			    "78740": ["EVECQUEMONT"],
			    "78410": ["LA FALAISE"],
			    "78200": ["FAVRIEUX"],
			    "78810": ["FEUCHEROLLES"],
			    "78200": ["FLACOURT"],
			    "78910": ["FLEXANVILLE"],
			    "78790": ["FLINS NEUVE EGLISE"],
			    "78410": ["FLINS SUR SEINE"],
			    "78520": ["FOLLAINVILLE DENNEMONT"],
			    "78330": ["FONTENAY LE FLEURY"],
			    "78200": ["FONTENAY MAUVOISIN"],
			    "78440": ["FONTENAY ST PERE"],
			    "78840": ["FRENEUSE"],
			    "78250": ["GAILLON SUR MONTCIENT"],
			    "78490": ["GALLUIS"],
			    "78950": ["GAMBAIS"],
			    "78490": ["GAMBAISEUIL"],
			    "78890": ["GARANCIERES"],
			    "78440": ["GARGENVILLE"],
			    "78125": ["GAZERAN"],
			    "78270": ["GOMMECOURT"],
			    "78770": ["GOUPILLIERES"],
			    "78930": ["GOUSSONVILLE"],
			    "78113": ["GRANDCHAMP"],
			    "78550": ["GRESSEY"],
			    "78490": ["GROSROUVRE"],
			    "78520": ["GUERNES"],
			    "78930": ["GUERVILLE"],
			    "78440": ["GUITRANCOURT"],
			    "78280": ["GUYANCOURT"],
			    "78250": ["HARDRICOURT"],
			    "78790": ["HARGEVILLE"],
			    "78113": ["LA HAUTEVILLE"],
			    "78580": ["HERBEVILLE"],
			    "78125": ["HERMERAY"],
			    "78550": ["HOUDAN"],
			    "78800": ["HOUILLES"],
			    "78440": ["ISSOU"],
			    "78440": ["JAMBVILLE"],
			    "78270": ["NOTRE DAME DE LA MER"],
			    "78760": ["JOUARS PONTCHARTRAIN"],
			    "78350": ["JOUY EN JOSAS"],
			    "78200": ["JOUY MAUVOISIN"],
			    "78580": ["JUMEAUVILLE"],
			    "78820": ["JUZIERS"],
			    "78440": ["LAINVILLE EN VEXIN"],
			    "78320": ["LEVIS ST NOM"],
			    "78520": ["LIMAY"],
			    "78270": ["LIMETZ VILLEZ"],
			    "78350": ["LES LOGES EN JOSAS"],
			    "78270": ["LOMMOYE"],
			    "78980": ["LONGNES"],
			    "78730": ["LONGVILLIERS"],
			    "78430": ["LOUVECIENNES"],
			    "78200": ["MAGNANVILLE"],
			    "78114": ["MAGNY LES HAMEAUX"],
			    "78600": ["MAISONS LAFFITTE"],
			    "78200": ["MANTES LA JOLIE"],
			    "78711": ["MANTES LA VILLE"],
			    "78770": ["MARCQ"],
			    "78490": ["MAREIL LE GUYON"],
			    "78750": ["MAREIL MARLY"],
			    "78124": ["MAREIL SUR MAULDRE"],
			    "78160": ["MARLY LE ROI"],
			    "78580": ["MAULE"],
			    "78550": ["MAULETTE"],
			    "78780": ["MAURECOURT"],
			    "78310": ["MAUREPAS"],
			    "78670": ["MEDAN"],
			    "78200": ["MENERVILLE"],
			    "78490": ["MERE"],
			    "78270": ["MERICOURT"],
			    "78600": ["LE MESNIL LE ROI"],
			    "78320": ["LE MESNIL ST DENIS"],
			    "78490": ["LES MESNULS"],
			    "78250": ["MEULAN EN YVELINES"],
			    "78970": ["MEZIERES SUR SEINE"],
			    "78250": ["MEZY SUR SEINE"],
			    "78940": ["MILLEMONT"],
			    "78470": ["MILON LA CHAPELLE"],
			    "78125": ["MITTAINVILLE"],
			    "78840": ["MOISSON"],
			    "78980": ["MONDREVILLE"],
			    "78124": ["MONTAINVILLE"],
			    "78440": ["MONTALET LE BOIS"],
			    "78790": ["MONTCHAUVET"],
			    "78360": ["MONTESSON"],
			    "78490": ["MONTFORT L AMAURY"],
			    "78180": ["MONTIGNY LE BRETONNEUX"],
			    "78630": ["MORAINVILLIERS"],
			    "78270": ["MOUSSEAUX SUR SEINE"],
			    "78790": ["MULCENT"],
			    "78130": ["LES MUREAUX"],
			    "78640": ["NEAUPHLE LE CHATEAU"],
			    "78640": ["NEAUPHLE LE VIEUX"],
			    "78980": ["NEAUPHLETTE"],
			    "78410": ["NEZEL"],
			    "78590": ["NOISY LE ROI"],
			    "78250": ["OINVILLE SUR MONTCIENT"],
			    "78125": ["ORCEMONT"],
			    "78910": ["ORGERUS"],
			    "78630": ["ORGEVAL"],
			    "78125": ["ORPHIN"],
			    "78660": ["ORSONVILLE"],
			    "78910": ["ORVILLIERS"],
			    "78910": ["OSMOY"],
			    "78660": ["PARAY DOUAVILLE"],
			    "78230": ["LE PECQ"],
			    "78200": ["PERDREAUVILLE"],
			    "78610": ["LE PERRAY EN YVELINES"],
			    "78370": ["PLAISIR"],
			    "78125": ["POIGNY LA FORET"],
			    "78300": ["POISSY"],
			    "78730": ["PONTHEVRARD"],
			    "78440": ["PORCHEVILLE"],
			    "78560": ["LE PORT MARLY"],
			    "78910": ["PRUNAY LE TEMPLE"],
			    "78660": ["PRUNAY EN YVELINES"],
			    "78940": ["LA QUEUE LES YVELINES"],
			    "78125": ["RAIZEUX"],
			    "78120": ["RAMBOUILLET"],
			    "78590": ["RENNEMOULIN"],
			    "78550": ["RICHEBOURG"],
			    "78730": ["ROCHEFORT EN YVELINES"],
			    "78270": ["ROLLEBOISE"],
			    "78790": ["ROSAY"],
			    "78710": ["ROSNY SUR SEINE"],
			    "78440": ["SAILLY"],
			    "78730": ["ST ARNOULT EN YVELINES"],
			    "78210": ["ST CYR L ECOLE"],
			    "78720": ["ST FORGET"],
			    "78640": ["ST GERMAIN DE LA GRANGE"],
			    "78100": ["ST GERMAIN EN LAYE"],
			    "78112": ["ST GERMAIN EN LAYE"],
			    "78125": ["ST HILARION"],
			    "78980": ["ST ILLIERS LA VILLE"],
			    "78980": ["ST ILLIERS LE BOIS"],
			    "78470": ["ST LAMBERT"],
			    "78610": ["ST LEGER EN YVELINES"],
			    "78660": ["ST MARTIN DE BRETHENCOURT"],
			    "78790": ["ST MARTIN DES CHAMPS"],
			    "78520": ["ST MARTIN LA GARENNE"],
			    "78730": ["STE MESME"],
			    "78860": ["ST NOM LA BRETECHE"],
			    "78470": ["ST REMY LES CHEVREUSE"],
			    "78690": ["ST REMY L HONORE"],
			    "78500": ["SARTROUVILLE"],
			    "78650": ["SAULX MARCHAIS"],
			    "78720": ["SENLISSE"],
			    "78790": ["SEPTEUIL"],
			    "78200": ["SOINDRES"],
			    "78120": ["SONCHAMP"],
			    "78910": ["TACOIGNIERES"],
			    "78113": ["LE TARTRE GAUDRAN"],
			    "78980": ["LE TERTRE ST DENIS"],
			    "78250": ["TESSANCOURT SUR AUBETTE"],
			    "78850": ["THIVERVAL GRIGNON"],
			    "78770": ["THOIRY"],
			    "78790": ["TILLY"],
			    "78117": ["TOUSSUS LE NOBLE"],
			    "78190": ["TRAPPES"],
			    "78490": ["LE TREMBLAY SUR MAULDRE"],
			    "78510": ["TRIEL SUR SEINE"],
			    "78740": ["VAUX SUR SEINE"],
			    "78140": ["VELIZY VILLACOUBLAY"],
			    "78480": ["VERNEUIL SUR SEINE"],
			    "78540": ["VERNOUILLET"],
			    "78320": ["LA VERRIERE"],
			    "78000": ["VERSAILLES"],
			    "78930": ["VERT"],
			    "78110": ["LE VESINET"],
			    "78490": ["VICQ"],
			    "78125": ["VIEILLE EGLISE EN YVELINES"],
			    "78270": ["LA VILLENEUVE EN CHEVRIE"],
			    "78670": ["VILLENNES SUR SEINE"],
			    "78450": ["VILLEPREUX"],
			    "78930": ["VILLETTE"],
			    "78770": ["VILLIERS LE MAHIEU"],
			    "78640": ["VILLIERS ST FREDERIC"],
			    "78220": ["VIROFLAY"],
			    "78960": ["VOISINS LE BRETONNEUX"],
			    "91150": ["ABBEVILLE LA RIVIERE"],
			    "91670": ["ANGERVILLE"],
			    "91470": ["ANGERVILLIERS"],
			    "91290": ["ARPAJON"],
			    "91690": ["ARRANCOURT"],
			    "91200": ["ATHIS MONS"],
			    "91410": ["AUTHON LA PLAINE"],
			    "91830": ["AUVERNAUX"],
			    "91580": ["AUVERS ST GEORGES"],
			    "91630": ["AVRAINVILLE"],
			    "91160": ["BALLAINVILLIERS"],
			    "91610": ["BALLANCOURT SUR ESSONNE"],
			    "91590": ["BAULNE"],
			    "91570": ["BIEVRES"],
			    "91150": ["BLANDY"],
			    "91720": ["BOIGNEVILLE"],
			    "91150": ["BOIS HERPIN"],
			    "91690": ["BOISSY LA RIVIERE"],
			    "91590": ["BOISSY LE CUTTE"],
			    "91870": ["BOISSY LE SEC"],
			    "91790": ["BOISSY SOUS ST YON"],
			    "91070": ["BONDOUFLE"],
			    "91470": ["BOULLAY LES TROUX"],
			    "91850": ["BOURAY SUR JUINE"],
			    "91800": ["BOUSSY ST ANTOINE"],
			    "91150": ["BOUTERVILLIERS"],
			    "91820": ["BOUTIGNY SUR ESSONNE"],
			    "91880": ["BOUVILLE"],
			    "91220": ["BRETIGNY SUR ORGE"],
			    "91650": ["BREUILLET"],
			    "91650": ["BREUX JOUY"],
			    "91150": ["BRIERES LES SCELLES"],
			    "91640": ["BRIIS SOUS FORGES"],
			    "91150": ["BROUY"],
			    "91800": ["BRUNOY"],
			    "91680": ["BRUYERES LE CHATEL"],
			    "91720": ["BUNO BONNEVAUX"],
			    "91440": ["BURES SUR YVETTE"],
			    "91590": ["CERNY"],
			    "91780": ["CHALO ST MARS"],
			    "91740": ["CHALOU MOULINEUX"],
			    "91730": ["CHAMARANDE"],
			    "91750": ["CHAMPCUEIL"],
			    "91160": ["CHAMPLAN"],
			    "91150": ["CHAMPMOTTEUX"],
			    "91410": ["CHATIGNONVILLE"],
			    "91580": ["CHAUFFOUR LES ETRECHY"],
			    "91630": ["CHEPTAINVILLE"],
			    "91750": ["CHEVANNES"],
			    "91380": ["CHILLY MAZARIN"],
			    "91100": ["CORBEIL ESSONNES"],
			    "91410": ["CORBREUSE"],
			    "91830": ["LE COUDRAY MONTCEAUX"],
			    "91490": ["COURANCES"],
			    "91720": ["COURDIMANCHE SUR ESSONNE"],
			    "91680": ["COURSON MONTELOUP"],
			    "91560": ["CROSNE"],
			    "91490": ["DANNEMOIS"],
			    "91590": ["D HUISON LONGUEVILLE"],
			    "91410": ["DOURDAN"],
			    "91210": ["DRAVEIL"],
			    "91540": ["ECHARCON"],
			    "91520": ["EGLY"],
			    "91860": ["EPINAY SOUS SENART"],
			    "91360": ["EPINAY SUR ORGE"],
			    "91150": ["ETAMPES"],
			    "91450": ["ETIOLLES"],
			    "91580": ["ETRECHY"],
			    "91000": ["EVRY COURCOURONNES"],
			    "91080": ["EVRY COURCOURONNES"],
			    "91590": ["LA FERTE ALAIS"],
			    "91700": ["FLEURY MEROGIS"],
			    "91690": ["FONTAINE LA RIVIERE"],
			    "91640": ["FONTENAY LES BRIIS"],
			    "91540": ["FONTENAY LE VICOMTE"],
			    "91410": ["LA FORET LE ROI"],
			    "91150": ["LA FORET STE CROIX"],
			    "91470": ["FORGES LES BAINS"],
			    "91190": ["GIF SUR YVETTE"],
			    "91720": ["GIRONVILLE SUR ESSONNE"],
			    "91400": ["GOMETZ LA VILLE"],
			    "91940": ["GOMETZ LE CHATEL"],
			    "91410": ["LES GRANGES LE ROI"],
			    "91350": ["GRIGNY"],
			    "91630": ["GUIBEVILLE"],
			    "91590": ["GUIGNEVILLE SUR ESSONNE"],
			    "91690": ["GUILLERVAL"],
			    "91430": ["IGNY"],
			    "91760": ["ITTEVILLE"],
			    "91510": ["JANVILLE SUR JUINE"],
			    "91640": ["JANVRY"],
			    "91260": ["JUVISY SUR ORGE"],
			    "91510": ["LARDY"],
			    "91630": ["LEUDEVILLE"],
			    "91310": ["LEUVILLE SUR ORGE"],
			    "91470": ["LIMOURS"],
			    "91310": ["LINAS"],
			    "91090": ["LISSES"],
			    "91160": ["LONGJUMEAU"],
			    "91310": ["LONGPONT SUR ORGE"],
			    "91720": ["MAISSE"],
			    "91460": ["MARCOUSSIS"],
			    "91150": ["MAROLLES EN BEAUCE"],
			    "91630": ["MAROLLES EN HUREPOIX"],
			    "91300": ["MASSY"],
			    "91730": ["MAUCHAMPS"],
			    "91540": ["MENNECY"],
			    "91660": ["LE MEREVILLOIS"],
			    "91780": ["MEROBERT"],
			    "91150": ["MESPUITS"],
			    "91490": ["MILLY LA FORET"],
			    "91490": ["MOIGNY SUR ECOLE"],
			    "91470": ["LES MOLIERES"],
			    "91590": ["MONDEVILLE"],
			    "91930": ["MONNERVILLE"],
			    "91230": ["MONTGERON"],
			    "91310": ["MONTLHERY"],
			    "91420": ["MORANGIS"],
			    "91150": ["MORIGNY CHAMPIGNY"],
			    "91390": ["MORSANG SUR ORGE"],
			    "91250": ["MORSANG SUR SEINE"],
			    "91750": ["NAINVILLE LES ROCHES"],
			    "91290": ["LA NORVILLE"],
			    "91620": ["NOZAY"],
			    "91340": ["OLLAINVILLE"],
			    "91490": ["ONCY SUR ECOLE"],
			    "91540": ["ORMOY"],
			    "91150": ["ORMOY LA RIVIERE"],
			    "91400": ["ORSAY"],
			    "91590": ["ORVEAU"],
			    "91120": ["PALAISEAU"],
			    "91550": ["PARAY VIEILLE POSTE"],
			    "94390": ["PARAY VIEILLE POSTE"],
			    "91470": ["PECQUEUSE"],
			    "91220": ["LE PLESSIS PATE"],
			    "91410": ["PLESSIS ST BENOIST"],
			    "91720": ["PRUNAY SUR ESSONNE"],
			    "91150": ["PUISELET LE MARAIS"],
			    "91740": ["PUSSAY"],
			    "91480": ["QUINCY SOUS SENART"],
			    "91410": ["RICHARVILLE"],
			    "91130": ["RIS ORANGIS"],
			    "91410": ["ROINVILLE"],
			    "91150": ["ROINVILLIERS"],
			    "91690": ["SACLAS"],
			    "91400": ["SACLAY"],
			    "91190": ["ST AUBIN"],
			    "91530": ["ST CHERON"],
			    "91690": ["ST CYR LA RIVIERE"],
			    "91410": ["ST CYR SOUS DOURDAN"],
			    "91410": ["ST ESCOBILLE"],
			    "91700": ["STE GENEVIEVE DES BOIS"],
			    "91180": ["ST GERMAIN LES ARPAJON"],
			    "91250": ["ST GERMAIN LES CORBEIL"],
			    "91780": ["ST HILAIRE"],
			    "91940": ["ST JEAN DE BEAUREGARD"],
			    "91530": ["ST MAURICE MONTCOURONNE"],
			    "91240": ["ST MICHEL SUR ORGE"],
			    "91280": ["ST PIERRE DU PERRAY"],
			    "91250": ["SAINTRY SUR SEINE"],
			    "91910": ["ST SULPICE DE FAVIERES"],
			    "91770": ["ST VRAIN"],
			    "91650": ["ST YON"],
			    "91160": ["SAULX LES CHARTREUX"],
			    "91600": ["SAVIGNY SUR ORGE"],
			    "91530": ["SERMAISE"],
			    "91840": ["SOISY SUR ECOLE"],
			    "91450": ["SOISY SUR SEINE"],
			    "91580": ["SOUZY LA BRICHE"],
			    "91740": ["CONGERVILLE THIONVILLE"],
			    "91250": ["TIGERY"],
			    "91730": ["TORFOU"],
			    "91720": ["VALPUISEAUX"],
			    "91530": ["LE VAL ST GERMAIN"],
			    "91480": ["VARENNES JARCY"],
			    "91640": ["VAUGRIGNEUSE"],
			    "91430": ["VAUHALLAN"],
			    "91820": ["VAYRES SUR ESSONNE"],
			    "91370": ["VERRIERES LE BUISSON"],
			    "91810": ["VERT LE GRAND"],
			    "91710": ["VERT LE PETIT"],
			    "91890": ["VIDELLES"],
			    "91270": ["VIGNEUX SUR SEINE"],
			    "91100": ["VILLABE"],
			    "91140": ["VILLEBON SUR YVETTE"],
			    "91580": ["VILLECONIN"],
			    "91620": ["LA VILLE DU BOIS"],
			    "91140": ["VILLEJUST"],
			    "91360": ["VILLEMOISSON SUR ORGE"],
			    "91580": ["VILLENEUVE SUR AUVERS"],
			    "91190": ["VILLIERS LE BACLE"],
			    "91700": ["VILLIERS SUR ORGE"],
			    "91170": ["VIRY CHATILLON"],
			    "91320": ["WISSOUS"],
			    "91330": ["YERRES"],
			    "91940": ["LES ULIS"],
			    "92160": ["ANTONY"],
			    "92600": ["ASNIERES SUR SEINE"],
			    "92220": ["BAGNEUX"],
			    "92270": ["BOIS COLOMBES"],
			    "92100": ["BOULOGNE BILLANCOURT"],
			    "92340": ["BOURG LA REINE"],
			    "92290": ["CHATENAY MALABRY"],
			    "92320": ["CHATILLON"],
			    "92370": ["CHAVILLE"],
			    "92140": ["CLAMART"],
			    "92110": ["CLICHY"],
			    "92700": ["COLOMBES"],
			    "92400": ["COURBEVOIE"],
			    "92260": ["FONTENAY AUX ROSES"],
			    "92380": ["GARCHES"],
			    "92250": ["LA GARENNE COLOMBES"],
			    "92230": ["GENNEVILLIERS"],
			    "92130": ["ISSY LES MOULINEAUX"],
			    "92300": ["LEVALLOIS PERRET"],
			    "92240": ["MALAKOFF"],
			    "92430": ["MARNES LA COQUETTE"],
			    "92190": ["MEUDON"],
			    "92360": ["MEUDON"],
			    "92120": ["MONTROUGE"],
			    "92000": ["NANTERRE"],
			    "92200": ["NEUILLY SUR SEINE"],
			    "92350": ["LE PLESSIS ROBINSON"],
			    "92800": ["PUTEAUX"],
			    "92500": ["RUEIL MALMAISON"],
			    "92210": ["ST CLOUD"],
			    "92330": ["SCEAUX"],
			    "92310": ["SEVRES"],
			    "92150": ["SURESNES"],
			    "92170": ["VANVES"],
			    "92420": ["VAUCRESSON"],
			    "92410": ["VILLE D AVRAY"],
			    "92390": ["VILLENEUVE LA GARENNE"],
			    "93300": ["AUBERVILLIERS"],
			    "93600": ["AULNAY SOUS BOIS"],
			    "93170": ["BAGNOLET"],
			    "93150": ["LE BLANC MESNIL"],
			    "93000": ["BOBIGNY"],
			    "93140": ["BONDY"],
			    "93350": ["LE BOURGET"],
			    "93390": ["CLICHY SOUS BOIS"],
			    "93470": ["COUBRON"],
			    "93120": ["LA COURNEUVE"],
			    "93700": ["DRANCY"],
			    "93440": ["DUGNY"],
			    "93800": ["EPINAY SUR SEINE"],
			    "93220": ["GAGNY"],
			    "93460": ["GOURNAY SUR MARNE"],
			    "93450": ["L ILE ST DENIS"],
			    "93260": ["LES LILAS"],
			    "93190": ["LIVRY GARGAN"],
			    "93370": ["MONTFERMEIL"],
			    "93100": ["MONTREUIL"],
			    "93360": ["NEUILLY PLAISANCE"],
			    "93330": ["NEUILLY SUR MARNE"],
			    "93160": ["NOISY LE GRAND"],
			    "93130": ["NOISY LE SEC"],
			    "93500": ["PANTIN"],
			    "93320": ["LES PAVILLONS SOUS BOIS"],
			    "93380": ["PIERREFITTE SUR SEINE"],
			    "93310": ["LE PRE ST GERVAIS"],
			    "93340": ["LE RAINCY"],
			    "93230": ["ROMAINVILLE"],
			    "93110": ["ROSNY SOUS BOIS"],
			    "93200": ["ST DENIS"],
			    "93210": ["ST DENIS"],
			    "93400": ["ST OUEN SUR SEINE"],
			    "93270": ["SEVRAN"],
			    "93240": ["STAINS"],
			    "93290": ["TREMBLAY EN FRANCE"],
			    "93410": ["VAUJOURS"],
			    "93250": ["VILLEMOMBLE"],
			    "93420": ["VILLEPINTE"],
			    "93430": ["VILLETANEUSE"],
			    "94480": ["ABLON SUR SEINE"],
			    "94140": ["ALFORTVILLE"],
			    "94110": ["ARCUEIL"],
			    "94470": ["BOISSY ST LEGER"],
			    "94380": ["BONNEUIL SUR MARNE"],
			    "94360": ["BRY SUR MARNE"],
			    "94230": ["CACHAN"],
			    "94500": ["CHAMPIGNY SUR MARNE"],
			    "94220": ["CHARENTON LE PONT"],
			    "94430": ["CHENNEVIERES SUR MARNE"],
			    "94550": ["CHEVILLY LARUE"],
			    "94600": ["CHOISY LE ROI"],
			    "94000": ["CRETEIL"],
			    "94120": ["FONTENAY SOUS BOIS"],
			    "94260": ["FRESNES"],
			    "94250": ["GENTILLY"],
			    "94240": ["L HAY LES ROSES"],
			    "94200": ["IVRY SUR SEINE"],
			    "94340": ["JOINVILLE LE PONT"],
			    "94270": ["LE KREMLIN BICETRE"],
			    "94450": ["LIMEIL BREVANNES"],
			    "94700": ["MAISONS ALFORT"],
			    "94520": ["MANDRES LES ROSES"],
			    "94440": ["MAROLLES EN BRIE"],
			    "94130": ["NOGENT SUR MARNE"],
			    "94880": ["NOISEAU"],
			    "94310": ["ORLY"],
			    "94490": ["ORMESSON SUR MARNE"],
			    "94520": ["PERIGNY"],
			    "94170": ["LE PERREUX SUR MARNE"],
			    "94420": ["LE PLESSIS TREVISE"],
			    "94510": ["LA QUEUE EN BRIE"],
			    "94150": ["RUNGIS"],
			    "94160": ["ST MANDE"],
			    "94100": ["ST MAUR DES FOSSES"],
			    "94210": ["ST MAUR DES FOSSES"],
			    "94410": ["ST MAURICE"],
			    "94440": ["SANTENY"],
			    "94370": ["SUCY EN BRIE"],
			    "94320": ["THIAIS"],
			    "94460": ["VALENTON"],
			    "94440": ["VILLECRESNES"],
			    "94800": ["VILLEJUIF"],
			    "94290": ["VILLENEUVE LE ROI"],
			    "94190": ["VILLENEUVE ST GEORGES"],
			    "94350": ["VILLIERS SUR MARNE"],
			    "94300": ["VINCENNES"],
			    "94400": ["VITRY SUR SEINE"],
			    "95450": ["ABLEIGES"],
			    "95510": ["AINCOURT"],
			    "95420": ["AMBLEVILLE"],
			    "95710": ["AMBLEVILLE"],
			    "95510": ["AMENUCOURT"],
			    "95580": ["ANDILLY"],
			    "95100": ["ARGENTEUIL"],
			    "95400": ["ARNOUVILLE"],
			    "95810": ["ARRONVILLE"],
			    "95420": ["ARTHIES"],
			    "95270": ["ASNIERES SUR OISE"],
			    "95570": ["ATTAINVILLE"],
			    "95430": ["AUVERS SUR OISE"],
			    "95450": ["AVERNES"],
			    "95560": ["BAILLET EN FRANCE"],
			    "95420": ["BANTHELU"],
			    "95250": ["BEAUCHAMP"],
			    "95260": ["BEAUMONT SUR OISE"],
			    "95750": ["LE BELLAY EN VEXIN"],
			    "95270": ["BELLEFONTAINE"],
			    "95270": ["BELLOY EN FRANCE"],
			    "95340": ["BERNES SUR OISE"],
			    "95810": ["BERVILLE"],
			    "95550": ["BESSANCOURT"],
			    "95840": ["BETHEMONT LA FORET"],
			    "95870": ["BEZONS"],
			    "95000": ["BOISEMONT"],
			    "95650": ["BOISSY L AILLERIE"],
			    "95500": ["BONNEUIL EN FRANCE"],
			    "95570": ["BOUFFEMONT"],
			    "95720": ["BOUQUEVAL"],
			    "95710": ["BRAY ET LU"],
			    "95640": ["BREANCON"],
			    "95640": ["BRIGNANCOURT"],
			    "95820": ["BRUYERES SUR OISE"],
			    "95770": ["BUHY"],
			    "95430": ["BUTRY SUR OISE"],
			    "95000": ["CERGY"],
			    "95800": ["CERGY"],
			    "95660": ["CHAMPAGNE SUR OISE"],
			    "95420": ["LA CHAPELLE EN VEXIN"],
			    "95420": ["CHARMONT"],
			    "95750": ["CHARS"],
			    "95190": ["CHATENAY EN FRANCE"],
			    "95270": ["CHAUMONTEL"],
			    "95710": ["CHAUSSY"],
			    "95560": ["CHAUVRY"],
			    "95380": ["CHENNEVIERES LES LOUVRES"],
			    "95510": ["CHERENCE"],
			    "95420": ["CLERY EN VEXIN"],
			    "95450": ["COMMENY"],
			    "95450": ["CONDECOURT"],
			    "95240": ["CORMEILLES EN PARISIS"],
			    "95830": ["CORMEILLES EN VEXIN"],
			    "95650": ["COURCELLES SUR VIOSNE"],
			    "95800": ["COURDIMANCHE"],
			    "95170": ["DEUIL LA BARRE"],
			    "95330": ["DOMONT"],
			    "95600": ["EAUBONNE"],
			    "95440": ["ECOUEN"],
			    "95880": ["ENGHIEN LES BAINS"],
			    "95300": ["ENNERY"],
			    "95380": ["EPIAIS LES LOUVRES"],
			    "95810": ["EPIAIS RHUS"],
			    "95270": ["EPINAY CHAMPLATREUX"],
			    "95610": ["ERAGNY"],
			    "95120": ["ERMONT"],
			    "95460": ["EZANVILLE"],
			    "95190": ["FONTENAY EN PARISIS"],
			    "95470": ["FOSSES"],
			    "95130": ["FRANCONVILLE"],
			    "95450": ["FREMAINVILLE"],
			    "95830": ["FREMECOURT"],
			    "95740": ["FREPILLON"],
			    "95530": ["LA FRETTE SUR SEINE"],
			    "95690": ["FROUVILLE"],
			    "95140": ["GARGES LES GONESSE"],
			    "95420": ["GENAINVILLE"],
			    "95650": ["GENICOURT"],
			    "95500": ["GONESSE"],
			    "95190": ["GOUSSAINVILLE"],
			    "95810": ["GRISY LES PLATRES"],
			    "95410": ["GROSLAY"],
			    "95450": ["GUIRY EN VEXIN"],
			    "95640": ["HARAVILLIERS"],
			    "95780": ["HAUTE ISLE"],
			    "95640": ["LE HEAULME"],
			    "95690": ["HEDOUVILLE"],
			    "95220": ["HERBLAY SUR SEINE"],
			    "95300": ["HEROUVILLE EN VEXIN"],
			    "95420": ["HODENT"],
			    "95290": ["L ISLE ADAM"],
			    "95850": ["JAGNY SOUS BOIS"],
			    "95280": ["JOUY LE MOUTIER"],
			    "95690": ["LABBEVILLE"],
			    "95270": ["LASSY"],
			    "95300": ["LIVILLIERS"],
			    "95450": ["LONGUESSE"],
			    "95380": ["LOUVRES"],
			    "95270": ["LUZARCHES"],
			    "95560": ["MAFFLIERS"],
			    "95420": ["MAGNY EN VEXIN"],
			    "95850": ["MAREIL EN FRANCE"],
			    "95580": ["MARGENCY"],
			    "95640": ["MARINES"],
			    "95670": ["MARLY LA VILLE"],
			    "95420": ["MAUDETOUR EN VEXIN"],
			    "95810": ["MENOUVILLE"],
			    "95180": ["MENUCOURT"],
			    "95630": ["MERIEL"],
			    "95540": ["MERY SUR OISE"],
			    "95720": ["LE MESNIL AUBRY"],
			    "95570": ["MOISSELLES"],
			    "95650": ["MONTGEROULT"],
			    "95370": ["MONTIGNY LES CORMEILLES"],
			    "95680": ["MONTLIGNON"],
			    "95360": ["MONTMAGNY"],
			    "95160": ["MONTMORENCY"],
			    "95770": ["MONTREUIL SUR EPTE"],
			    "95560": ["MONTSOULT"],
			    "95260": ["MOURS"],
			    "95640": ["MOUSSY"],
			    "95590": ["NERVILLE LA FORET"],
			    "95690": ["NESLES LA VALLEE"],
			    "95640": ["NEUILLY EN VEXIN"],
			    "95000": ["NEUVILLE SUR OISE"],
			    "95590": ["NOINTEL"],
			    "95270": ["NOISY SUR OISE"],
			    "95420": ["NUCOURT"],
			    "95420": ["OMERVILLE"],
			    "95520": ["OSNY"],
			    "95620": ["PARMAIN"],
			    "95450": ["LE PERCHAY"],
			    "95340": ["PERSAN"],
			    "95220": ["PIERRELAYE"],
			    "95480": ["PIERRELAYE"],
			    "95350": ["PISCOP"],
			    "95130": ["LE PLESSIS BOUCHARD"],
			    "95720": ["LE PLESSIS GASSOT"],
			    "95270": ["LE PLESSIS LUZARCHES"],
			    "95000": ["PONTOISE"],
			    "95300": ["PONTOISE"],
			    "95590": ["PRESLES"],
			    "95380": ["PUISEUX EN FRANCE"],
			    "95650": ["PUISEUX PONTOISE"],
			    "95780": ["LA ROCHE GUYON"],
			    "95700": ["ROISSY EN FRANCE"],
			    "95340": ["RONQUEROLLES"],
			    "95450": ["SAGY"],
			    "95350": ["ST BRICE SOUS FORET"],
			    "95770": ["ST CLAIR SUR EPTE"],
			    "95510": ["ST CYR EN ARTHIES"],
			    "95420": ["ST GERVAIS"],
			    "95210": ["ST GRATIEN"],
			    "95320": ["ST LEU LA FORET"],
			    "95270": ["ST MARTIN DU TERTRE"],
			    "95310": ["ST OUEN L AUMONE"],
			    "95390": ["ST PRIX"],
			    "95470": ["ST WITZ"],
			    "95110": ["SANNOIS"],
			    "95640": ["SANTEUIL"],
			    "95200": ["SARCELLES"],
			    "95450": ["SERAINCOURT"],
			    "95270": ["SEUGY"],
			    "95230": ["SOISY SOUS MONTMORENCY"],
			    "95470": ["SURVILLIERS"],
			    "95150": ["TAVERNY"],
			    "95450": ["THEMERICOURT"],
			    "95810": ["THEUVILLE"],
			    "95500": ["LE THILLAY"],
			    "95450": ["US"],
			    "95810": ["VALLANGOUJARD"],
			    "95760": ["VALMONDOIS"],
			    "95500": ["VAUDHERLAND"],
			    "95490": ["VAUREAL"],
			    "95470": ["VEMARS"],
			    "95510": ["VETHEUIL"],
			    "95270": ["VIARMES"],
			    "95510": ["VIENNE EN ARTHIES"],
			    "95450": ["VIGNY"],
			    "95570": ["VILLAINES SOUS BOIS"],
			    "95380": ["VILLERON"],
			    "95510": ["VILLERS EN ARTHIES"],
			    "95840": ["VILLIERS ADAM"],
			    "95400": ["VILLIERS LE BEL"],
			    "95720": ["VILLIERS LE SEC"],
			    "95420": ["WY DIT JOLI VILLAGE"]
			};
			
			const postalCityInput = document.getElementById('postal-city');
			const cityOptions = document.getElementById('city-options');
			
			postalCityInput.addEventListener('input', function() {
			    const inputValue = postalCityInput.value;
			    const cities = postalCodeToCity[inputValue];
			
			    cityOptions.innerHTML = '';
			    if (cities) {
			        cities.forEach(city => {
			            const option = document.createElement('option');
			            option.value = inputValue + ' ' + city;
			            cityOptions.appendChild(option);
			        });
			    }
			});
		</script>

		<script>
document.addEventListener("DOMContentLoaded", function () {
    const fileInputs = document.querySelectorAll(".file-upload");

    function getMateriel(input) {
        return input.closest("tr").querySelector("td:first-child").textContent.trim();
    }

    function loadData(key) {
        return JSON.parse(localStorage.getItem(key)) || {};
    }

    function saveData(key, data) {
        localStorage.setItem(key, JSON.stringify(data));
    }

    function dataURLtoBlob(dataURL) {
        let arr = dataURL.split(","), mime = arr[0].match(/:(.*?);/)[1];
        let bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
        while (n--) {
            u8arr[n] = bstr.charCodeAt(n);
        }
        return new Blob([u8arr], { type: mime });
    }

    let fileData = loadData("fileData");

    fileInputs.forEach(input => {
        let row = input.closest("tr");
        let marqueInput = row.querySelector(".marque-input");
        let modeleInput = row.querySelector(".modele-input");
        let dropzone = row.querySelector(".dropzone");
        let pdfPreview = row.querySelector(".pdf-preview");
        let removeBtn = row.querySelector(".remove-file");

        function getFileKey() {
            let materiel = getMateriel(input);
            let marque = marqueInput?.value.trim();
            let modele = modeleInput?.value.trim();
            if (!marque || !modele) return null;
            return `${materiel}-${marque}-${modele}`;
        }

        function updateFileDisplay() {
            let key = getFileKey();
            if (!key) return;

            if (fileData[key]) {
                let pdfBlob = dataURLtoBlob(fileData[key]);
                let objectURL = URL.createObjectURL(pdfBlob);

                pdfPreview.href = objectURL;
                pdfPreview.style.display = "inline"; // Show eye icon
                removeBtn.style.display = "inline"; // Show remove button
                dropzone.style.display = "none"; // Hide dropzone
                row.style.backgroundColor = "#e3f2fd"; // Light blue row styling
            } else {
                pdfPreview.style.display = "none"; // Hide eye icon
                removeBtn.style.display = "none"; // Hide remove button
                dropzone.style.display = "block"; // Show dropzone again
                row.style.backgroundColor = ""; // Reset row styling
            }
        }

        marqueInput?.addEventListener("change", updateFileDisplay);
        modeleInput?.addEventListener("change", updateFileDisplay);

        input.addEventListener("change", function () {
            let file = this.files[0];
            let key = getFileKey();
            if (!file || !key) return;

            let reader = new FileReader();
            reader.onload = function (e) {
                fileData[key] = e.target.result;
                saveData("fileData", fileData);
                updateFileDisplay();
            };
            reader.readAsDataURL(file);
        });

        removeBtn.addEventListener("click", function () {
            let key = getFileKey();
            if (key && fileData[key]) {
                delete fileData[key]; // Remove file from storage
                saveData("fileData", fileData);
                updateFileDisplay();
            }
        });

        updateFileDisplay(); // Ensure the row updates properly on page load
    });
});
		</script>

		<script>			
			document.addEventListener('DOMContentLoaded', function() {
			    // Define updateRowStyle function globally
			    window.updateRowStyle = function(row) {
			        const fileInput = row.querySelector('input[type="file"]');
			        const marqueInput = row.querySelectorAll('input[type="text"]')[0];
			        const modeleInput = row.querySelectorAll('input[type="text"]')[1];
			
			        const fileSelected = fileInput && fileInput.files.length > 0;
			        const marqueFilled = marqueInput ? marqueInput.value.trim() !== '' : false;
			        const modeleFilled = modeleInput ? modeleInput.value.trim() !== '' : false;
			
			        // "Fiches Techniques" section styles
			        if (row.classList.contains('fiches-techniques-row')) {
			            if (fileSelected && !marqueFilled && !modeleFilled) {
			                row.style.backgroundColor = '#ffd4d4'; // Light red background
			                row.style.fontWeight = 'bold';
			                row.style.color = '#a13a38'; // Red text
			            } else if (fileSelected && marqueFilled && !modeleFilled) {
			                row.style.backgroundColor = '#ffd4d4'; // Light red background
			                row.style.fontWeight = 'bold';
			                row.style.color = '#a13a38'; // Red text
			            } else if (fileSelected && !marqueFilled && modeleFilled) {
			                row.style.backgroundColor = '#ffd4d4'; // Light red background
			                row.style.fontWeight = 'bold';
			                row.style.color = '#a13a38'; // Red text
			            } else if (!fileSelected && marqueFilled && modeleFilled) {
			                row.style.backgroundColor = '#ffd4d4'; // Light red background
			                row.style.fontWeight = 'bold';
			                row.style.color = '#a13a38'; // Red text
			            } else if (!fileSelected && !marqueFilled && modeleFilled) {
			                row.style.backgroundColor = '#ffd4d4'; // Light red background
			                row.style.fontWeight = 'bold';
			                row.style.color = '#a13a38'; // Red text
			            } else if (!fileSelected && marqueFilled && !modeleFilled) {
			                row.style.backgroundColor = '#ffd4d4'; // Light red background
			                row.style.fontWeight = 'bold';
			                row.style.color = '#a13a38'; // Red text
			            } else if (fileSelected && marqueFilled && modeleFilled) {
			                row.style.backgroundColor = '#d1ebf0'; // Light blue background
			                row.style.fontWeight = 'bold';
			                row.style.color = '#3290a1'; // Blue text
			            } else {
			                row.style.backgroundColor = ''; // Reset background
			                row.style.fontWeight = 'normal';
			                row.style.color = ''; // Reset color
			            }
			        }
			
			        // "Process Verbaux" section styles
			        else if (row.classList.contains('proces-verbaux-row')) {
			            if (fileSelected) {
			                row.style.backgroundColor = '#d8e1f0'; // Light blue background
			                row.style.fontWeight = 'bold';
			                row.style.color = '#1e375c'; // Dark blue text
			            } else {
			                row.style.backgroundColor = ''; // Reset background
			                row.style.fontWeight = 'normal';
			                row.style.color = ''; // Reset color
			            }
			        }
			
			        // "Schemas" section styles
			        else if (row.classList.contains('schemas-row')) {
			            if (fileSelected) {
			                row.style.backgroundColor = '#fae5d2'; // Light orange background
			                row.style.fontWeight = 'bold';
			                row.style.color = '#cc6b16'; // Orange text
			            } else {
			                row.style.backgroundColor = ''; // Reset background
			                row.style.fontWeight = 'normal';
			                row.style.color = ''; // Reset color
			            }
			        }
			    };
			
			    // Attach event listeners for style updates
			    document.querySelectorAll('.fiches-techniques-row, .proces-verbaux-row, .schemas-row').forEach(row => {
			        row.querySelectorAll('input').forEach(input => {
			            input.addEventListener('input', () => updateRowStyle(row));
			        });
			    });
			
			    // Initialize each dropzone and add remove icon
			    function initializeDropzone(dropzoneId, fileInputId) {
			        const dropzoneContainer = document.getElementById(dropzoneId).parentNode;
			        const dropzone = document.getElementById(dropzoneId);
			        const fileInput = document.getElementById(fileInputId);
			        const removeIcon = dropzoneContainer.querySelector('.remove-file');
			
			        // Clicking on dropzone opens file input dialog
			        dropzone.addEventListener('click', () => fileInput.click());
			
			        // Styling on drag over and drag leave
			        dropzone.addEventListener('dragover', (e) => {
			            e.preventDefault();
			            dropzone.classList.add('dragover');
			        });
			        dropzone.addEventListener('dragleave', () => dropzone.classList.remove('dragover'));
			
			        // Handling file drop
			        dropzone.addEventListener('drop', (e) => {
			            e.preventDefault();
			            dropzone.classList.remove('dragover');
			            const file = e.dataTransfer.files[0];
			            if (file) {
			                fileInput.files = e.dataTransfer.files;
			                dropzone.innerText = file.name;
			                removeIcon.style.display = 'inline'; // Show remove icon
			                updateRowStyle(dropzone.closest('tr')); // Update style on file addition
			            }
			        });
			
			        // Handle file change event (when selecting file through file dialog)
			        fileInput.addEventListener('change', () => {
			            const file = fileInput.files[0];
			            if (file) {
			                dropzone.innerText = file.name;
			                removeIcon.style.display = 'inline';
			            } else {
			                dropzone.innerText = 'Cliquez ou déposez';
			                removeIcon.style.display = 'none';
			            }
			            updateRowStyle(dropzone.closest('tr')); // Update style on file change
			        });
			
			    // Remove file functionality
			    removeIcon.addEventListener('click', () => {
			        fileInput.value = ''; // Clear file input
			        dropzone.innerText = 'Cliquez ou déposez'; // Reset dropzone text
			        removeIcon.style.display = 'none'; // Hide remove icon
			
			        // Clear marque and modele inputs
			        const inputs = dropzone.closest('tr').querySelectorAll('input[type="text"]');
			        if (inputs.length >= 2) {
			            inputs[0].value = ''; // Clear marque input
			            inputs[1].value = ''; // Clear modele input
			        }
			
			        updateRowStyle(dropzone.closest('tr')); // Update style on file removal
			    });
			
			    }
			
			    // Initialize each dropzone with file input, drag-and-drop, and remove functionality
			    document.querySelectorAll('.fiches-techniques-row, .proces-verbaux-row, .schemas-row').forEach(row => {
			        const dropzone = row.querySelector('.dropzone');
			        const fileInput = row.querySelector('input[type="file"]');
			
			        if (dropzone && fileInput) {
			            const container = document.createElement('div');
			            container.className = 'dropzone-container';
			            dropzone.parentNode.insertBefore(container, dropzone);
			            container.appendChild(dropzone);
			            dropzone.insertAdjacentHTML('afterend', '<span class="remove-file" style="display: none;">&times;</span>');
			            initializeDropzone(dropzone.id, fileInput.id);
			            container.appendChild(dropzone.nextElementSibling); // Add remove icon to container
			        }
			    });
			});
		</script>
<script>
			document.getElementById('upload-form').addEventListener('submit', async function(e) {
			    e.preventDefault();
			    document.querySelector('.loader').style.display = 'inline-block';
			
			    const adresse = document.getElementById('adresse').value.toUpperCase();
			    const postalCity = document.getElementById('postal-city').value.toUpperCase();
			    const objet = document.getElementById('objet').value.toUpperCase();
			    const folderName = "DOE_" + adresse + " " + postalCity;
			
			    const dateInput = document.getElementById('date').value;
			    const [year, month, day] = dateInput.split('-');
			    const formattedDate = `${day}/${month}/${year}`;
			
			    const zip = new JSZip();
			    const mainFolder = zip.folder(folderName);
			    const fichesTechniquesFolder = mainFolder.folder("1 - FICHES TECHNIQUES");
			    const procesVerbauxFolder = mainFolder.folder("2 - PROCES VERBAUX");
			    const schemasFolder = mainFolder.folder("3 - SCHEMAS");
			
			    const mergedPdf = await PDFLib.PDFDocument.create();
			    const coverPage = mergedPdf.addPage([600, 800]);
			
			    const helveticaBold = await mergedPdf.embedFont(PDFLib.StandardFonts.HelveticaBold);
			    const helveticaOblique = await mergedPdf.embedFont(PDFLib.StandardFonts.HelveticaOblique);
			    const helvetica = await mergedPdf.embedFont(PDFLib.StandardFonts.Helvetica);
			
			    const coverPageTitleA = "DOSSIER DES";
			    const coverPageTitleB = "OUVRAGES EXECUTES";
			    const coverPageAdress = adresse;
			    const coverPageCode = postalCity;
			    const coverPageObjet = objet;
			    const coverPageDate = formattedDate;
			    const coverPageFooter = "SOPODEX - 82 rue Alexandre Dumas,75020 PARIS";
			
			    coverPage.drawText(coverPageTitleA, { x: 75, y: 720, size: 26, font: helveticaBold });
			    coverPage.drawText(coverPageTitleB, { x: 75, y: 690, size: 26, font: helveticaBold });
			    coverPage.drawText(coverPageAdress, { x: 75, y: 450, size: 26, font: helveticaBold });
			    coverPage.drawText(coverPageCode, { x: 75, y: 420, size: 26, font: helveticaBold });
			    coverPage.drawText(coverPageObjet, { x: 75, y: 390, size: 18, font: helveticaOblique });
			    coverPage.drawText(coverPageDate, { x: 75, y: 371, size: 16, font: helveticaOblique });
			    coverPage.drawText(coverPageFooter, { x: 75, y: 50, size: 12, font: helvetica });
			
			    coverPage.drawRectangle({ x: 75, y: 678, width: 85, height: 2, color: PDFLib.rgb(0, 0, 0) });
			    coverPage.drawRectangle({ x: 75, y: 0, width: 150, height: 10, color: PDFLib.rgb(0.19, 0.56, 0.63) });
			    coverPage.drawRectangle({ x: 225, y: 0, width: 150, height: 10, color: PDFLib.rgb(0.12, 0.21, 0.36) });
			    coverPage.drawRectangle({ x: 375, y: 0, width: 150, height: 10, color: PDFLib.rgb(0.8, 0.42, 0.086) });
			
			    const sectionFiles = {
			"FICHES TECHNIQUES": [ 
			{ name: 'ADOUCISSEUR', file: document.getElementById('adoucisseur-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[0].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[1].value.toUpperCase() },
			{ name: 'AQUASTAT ECS', file: document.getElementById('aquastat-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[2].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[3].value.toUpperCase() },
			{ name: 'BALLON ECS', file: document.getElementById('ballon-ecs-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[4].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[5].value.toUpperCase() },
			{ name: 'CHAUDIERE', file: document.getElementById('chaudiere-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[6].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[7].value.toUpperCase() },
			{ name: 'DESEMBOUEUR MAGNETIQUE', file: document.getElementById('desemboueur-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[8].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[9].value.toUpperCase() },
			{ name: 'ECHANGEUR CPCU', file: document.getElementById('echangeur-cpcu-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[10].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[11].value.toUpperCase() },
			{ name: 'ECHANGEUR DE DISCONNEXION', file: document.getElementById('echangeur-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[12].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[13].value.toUpperCase() },
			{ name: 'ELECTROVANNE GAZ', file: document.getElementById('electrovanne-gaz-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[14].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[15].value.toUpperCase() },
			{ name: 'GROUPE DE MAINTIEN DE PRESSION', file: document.getElementById('groupe-maintien-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[16].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[17].value.toUpperCase() },
			{ name: 'POMPE BALLON ECS', file: document.getElementById('pompe-ballon-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[18].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[19].value.toUpperCase() },
			{ name: 'POMPE CHARGE CHAUDIERE', file: document.getElementById('pompe-charge-chaudiere-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[20].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[21].value.toUpperCase() },
			{ name: 'POMPE CHAUFFAGE', file: document.getElementById('pompe-chauffage-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[22].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[23].value.toUpperCase() },
			{ name: 'POMPE DE RELEVAGE', file: document.getElementById('pompe-relevage-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[24].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[25].value.toUpperCase() },
			{ name: 'POMPE PRIMAIRE ECS', file: document.getElementById('pompe-primaire-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[26].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[27].value.toUpperCase() },
			{ name: 'POMPE RECYCLAGE ECS', file: document.getElementById('pompe-recyclage-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[28].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[29].value.toUpperCase() },
			{ name: 'PREPARATEUR ECS', file: document.getElementById('preparateur-ecs-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[30].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[31].value.toUpperCase() },
			{ name: 'PRESSOSTAT MANQUE D\'EAU', file: document.getElementById('pressostat-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[32].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[33].value.toUpperCase() },
			{ name: 'REGULATION ECS', file: document.getElementById('regulation-ecs-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[34].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[35].value.toUpperCase() },
			{ name: 'REGULATION VIESSMANN', file: document.getElementById('regulation-viessmann-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[36].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[37].value.toUpperCase() },
			{ name: 'SERVOMOTEUR CHAUFFAGE', file: document.getElementById('servomoteur-chauffage-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[38].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[39].value.toUpperCase() },
			{ name: 'SERVOMOTEUR ECS', file: document.getElementById('servomoteur-ecs-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[40].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[41].value.toUpperCase() },
			{ name: 'SOUPAPE DE SECURITE', file: document.getElementById('soupape-securite-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[42].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[43].value.toUpperCase() },
			{ name: 'TRAITEMENT FILMOGENE', file: document.getElementById('traitement-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[44].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[45].value.toUpperCase() },
			{ name: 'VANNE DEUX VOIES MOTORISEE', file: document.getElementById('vanne-deux-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[46].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[47].value.toUpperCase() },
			{ name: 'VANNE TROIS VOIES CHAUFFAGE', file: document.getElementById('vanne-trois-chauffage-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[48].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[49].value.toUpperCase() },
			{ name: 'VANNE TROIS VOIES ECS', file: document.getElementById('vanne-trois-ecs-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[50].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[51].value.toUpperCase() },
			{ name: 'VASE D\'EXPANSION CHAUFFAGE', file: document.getElementById('vase-chauffage-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[52].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[53].value.toUpperCase() },
			{ name: 'VASE D\'EXPANSION SANITAIRE', file: document.getElementById('vase-sanitaire-file').files[0], marque: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[54].value.toUpperCase(), modele: document.querySelectorAll('.fiches-techniques-row input[type="text"]')[55].value.toUpperCase() }
			],
			        "PROCES VERBAUX": [
			            { name: 'CERTIFICAT DE DECHARGE D\'AMIANTE', file: document.getElementById('certificat-amiante-file').files[0] },
			            { name: 'DEGAZAGE CUVE FIOUL', file: document.getElementById('degazage-cuve-file').files[0] },
			            { name: 'DETECTION GAZ', file: document.getElementById('detection-gaz-file').files[0] },
			            { name: 'FLOCAGE', file: document.getElementById('flocage-file').files[0] },
			            { name: 'MESURE ACOUSTIQUE', file: document.getElementById('mesure-acoustique-file').files[0] },
			            { name: 'MISE EN SERVICE ADOUCISSEUR', file: document.getElementById('service-adoucisseur-file').files[0] },
			            { name: 'MISE EN SERVICE CHAUDIERE', file: document.getElementById('service-chaudiere-file').files[0] },
			            { name: 'MISE EN SERVICE FILMOGENE', file: document.getElementById('service-filmogene-file').files[0] },
			            { name: 'MISE EN SERVICE OLDHAM', file: document.getElementById('service-oldham-file').files[0] },
			            { name: 'MISE EN SERVICE REFLEX', file: document.getElementById('service-reflex-file').files[0] },
			            { name: 'PORTE', file: document.getElementById('porte-file').files[0] },
			            { name: 'QUALIGAZ', file: document.getElementById('qualigaz-file').files[0] },
			            { name: 'RAPPORT DESEMBOUAGE', file: document.getElementById('rapport-desembouage-file').files[0] },
			            { name: 'TUBAGE', file: document.getElementById('tubage-file').files[0] }
			        ],
			        "SCHEMAS": [
			            { name: 'SCHEMA HYDRAULIQUE', file: document.getElementById('schema-hydraulique-file').files[0] },
			            { name: 'SCHEMA ELECTRIQUE', file: document.getElementById('schema-electrique-file').files[0] },
			            { name: 'EQUILIBRAGE', file: document.getElementById('equilibrage-file').files[0] }
			        ]
			    };
			
			function checkPageOverflow(pdfDoc, currentPage, yPosition) {
			if (yPosition < 100) {  // If content reaches the bottom
			    currentPage = pdfDoc.addPage([600, 800]);  // Create a new summary page
			    currentPage.drawText("SOMMAIRE", { x: 75, y: 720, size: 26, font: helveticaBold, color: PDFLib.rgb(0, 0, 0) });
			    currentPage.drawRectangle({ x: 75, y: 709, width: 85, height: 2, color: PDFLib.rgb(0, 0, 0) });
			
			    return { currentPage, yPosition: 650 };  // Reset Y position for new page
			}
			return { currentPage, yPosition };
			}
			
			    let summaryPage = mergedPdf.addPage([600, 800]);
			    summaryPage.drawText("SOMMAIRE", { x: 75, y: 720, size: 26, font: helveticaBold, color: PDFLib.rgb(0, 0, 0) });
			    summaryPage.drawRectangle({ x: 75, y: 709, width: 85, height: 2, color: PDFLib.rgb(0, 0, 0) });
			    summaryPage.drawText("DOE - " + adresse + ", " + postalCity + " - SOPODEX", { x: 75, y: 37, size: 9, font: helveticaOblique, color: PDFLib.rgb(0.5, 0.5, 0.5) });
			
			    let yPosition = 650;
			    const sectionColors = {
			        "FICHES TECHNIQUES": PDFLib.rgb(0.19, 0.56, 0.63),
			        "PROCES VERBAUX": PDFLib.rgb(0.12, 0.21, 0.36),
			        "SCHEMAS": PDFLib.rgb(0.8, 0.42, 0.086)
			    };
			
			    for (const section in sectionFiles) {
			
				const result = checkPageOverflow(mergedPdf, summaryPage, yPosition);
				summaryPage = result.currentPage;
				yPosition = result.yPosition;
			
			        const color = sectionColors[section];
			
			        summaryPage.drawRectangle({ x: 75, y: yPosition, width: 452, height: 25, color: color });
			        summaryPage.drawText(section, { x: 82, y: yPosition + 7, size: 14, font: helveticaBold, color: PDFLib.rgb(1, 1, 1) });
			
			        yPosition -= 0.2;
			        const rowHeight = (section === "FICHES TECHNIQUES") ? 30 : 20;
			
			        sectionFiles[section].forEach(fileObj => {
			            if (fileObj.file) {
			
					const result = checkPageOverflow(mergedPdf, summaryPage, yPosition);
					summaryPage = result.currentPage;
			yPosition = result.yPosition;
			
			                summaryPage.drawRectangle({ x: 75.5, y: yPosition - rowHeight, width: 451, height: rowHeight, borderWidth: 1, color: PDFLib.rgb(1, 1, 1), borderColor: PDFLib.rgb(0, 0, 0) });
			                summaryPage.drawText(fileObj.name, { x: 80, y: yPosition - 14, size: 10, font: helvetica });
			               
			if (fileObj.marque || fileObj.modele) {
			                    summaryPage.drawText(`${fileObj.marque || 'N/A'} - ${fileObj.modele || 'N/A'}`, { x: 80, y: yPosition - 25, size: 10, font: helveticaOblique, color: PDFLib.rgb(0.5, 0.5, 0.5) });
			                }
			                yPosition -= (rowHeight + 0.2);
			            }
			        });
			
			        yPosition -= 43;
			    }
			    summaryPage.drawRectangle({ x: 75, y: 0, width: 150, height: 10, color: PDFLib.rgb(0.19, 0.56, 0.63) });
			    summaryPage.drawRectangle({ x: 225, y: 0, width: 150, height: 10, color: PDFLib.rgb(0.12, 0.21, 0.36) });
			    summaryPage.drawRectangle({ x: 375, y: 0, width: 150, height: 10, color: PDFLib.rgb(0.8, 0.42, 0.086) });
			
			    async function addFileToMergedPdf(pdfDoc, sectionTitle, file, details) {
			        if (file) {
			            const arrayBuffer = await file.arrayBuffer();
			            try {
			                const filePdf = await PDFLib.PDFDocument.load(arrayBuffer, { ignoreEncryption: true });
			                const interpage = pdfDoc.addPage([600, 800]);
			                interpage.drawText(sectionTitle, { x: 75, y: 720, size: 26, font: helveticaBold, color: PDFLib.rgb(0, 0, 0) });
			                interpage.drawRectangle({ x: 75, y: 709, width: 85, height: 2, color: PDFLib.rgb(0, 0, 0) });
			                if (details.itemName) {
			                    interpage.drawText(details.itemName.toUpperCase(), { x: 75, y: 450, size: 22, font: helveticaBold, color: PDFLib.rgb(0.1, 0.1, 0.1) });
			                    
			                    // Add footer and bottom decorations for interpage
			                interpage.drawText(`DOE - ${adresse}, ${postalCity} - SOPODEX`, {
			                    x: 75,
			                    y: 37,
			                    size: 9,
			                    font: helveticaOblique,
			                    color: PDFLib.rgb(0.5, 0.5, 0.5)
			                });
			
			                const sectionColor = sectionColors[sectionTitle] || PDFLib.rgb(0.5, 0.5, 0.5);
			                interpage.drawRectangle({ x: 75, y: 0, width: 450, height: 10, color: sectionColor });
			
			                    if (sectionTitle === "FICHES TECHNIQUES") {
			                        interpage.drawText(`${details.marque || 'N/A'}`, { x: 100, y: 420, size: 16, font: helvetica, color: PDFLib.rgb(0.3, 0.3, 0.3) });
			                        interpage.drawText(`${details.modele || 'N/A'}`, { x: 100, y: 395, size: 16, font: helvetica, color: PDFLib.rgb(0.3, 0.3, 0.3) });
			                    }
			                }
			                
			                
			                const copiedPages = await pdfDoc.copyPages(filePdf, filePdf.getPageIndices());
			                copiedPages.forEach((page) => pdfDoc.addPage(page));
			            } catch (error) {
			                console.error("Error loading file:", file.name, error);
			            }
			        }
			    }
			
			    for (const fiche of sectionFiles["FICHES TECHNIQUES"]) {
			        await addFileToMergedPdf(mergedPdf, "FICHES TECHNIQUES", fiche.file, { itemName: fiche.name, marque: fiche.marque, modele: fiche.modele });
			        if (fiche.file) {
			            const arrayBuffer = await fiche.file.arrayBuffer();
			            fichesTechniquesFolder.file("[FT-" + fiche.name + "]_" + adresse + " " + postalCity + ".pdf", arrayBuffer);
			        }
			    }
			
			    for (const pv of sectionFiles["PROCES VERBAUX"]) {
			        await addFileToMergedPdf(mergedPdf, "PROCES VERBAUX", pv.file, { itemName: pv.name });
			        if (pv.file) {
			            const arrayBuffer = await pv.file.arrayBuffer();
			            procesVerbauxFolder.file("[PV-" + pv.name + "]_" + adresse + " " + postalCity + ".pdf", arrayBuffer);
			        }
			    }
			
			    for (const schema of sectionFiles["SCHEMAS"]) {
			        await addFileToMergedPdf(mergedPdf, "SCHEMAS", schema.file, { itemName: schema.name });
			        if (schema.file) {
			            const arrayBuffer = await schema.file.arrayBuffer();
			            schemasFolder.file("[SCH-" + schema.name + "]_" + adresse + " " + postalCity + ".pdf", arrayBuffer);
			        }
			    }
			
			    try {
			        const mergedPdfBytes = await mergedPdf.save();
			        mainFolder.file(folderName + ".pdf", mergedPdfBytes);
			
			        const content = await zip.generateAsync({ type: "blob" });
			        document.querySelector('.loader').style.display = 'none';
			
			        const zipUrl = URL.createObjectURL(content);
			        const downloadLink = document.createElement("a");
			        downloadLink.href = zipUrl;
			        downloadLink.download = folderName + ".zip";
			        downloadLink.click();
			        URL.revokeObjectURL(zipUrl);
			    } catch (error) {
			        console.error('Error generating zip:', error);
			        document.querySelector('.loader').style.display = 'none';
			    }
			});
		</script>
	<script>
		const adresse = document.getElementById('adresse').value.trim().toUpperCase();
		const postalCity = document.getElementById('postal-city').value.trim();
		
		// Split postal & city
		const [postalCode, ...cityParts] = postalCity.split(' ');
		const city = cityParts.join(' ').toUpperCase();
		
		// Custom ID
		const customID = `${adresse} - ${postalCode} ${city}`;
		
		// Now build your payload:
		const payload = {
		    id: customID,
		    adresse: document.getElementById('adresse').value,
		    postalCity: postalCity,
		    objet: document.getElementById('objet').value,
		    date: document.getElementById('date').value,
		    fiches: [...document.querySelectorAll('.fiches-techniques-row')].map(row => ({
		        marque: row.querySelector('.marque-input').value,
		        modele: row.querySelector('.modele-input').value
		    }))
		};
	</script>
	<script>
	console.log("Frontend JS loaded!");
document.getElementById('save-progress').addEventListener('click', async () => {
    // BUILD CUSTOM ID CORRECTLY
    const adresseInput = document.getElementById('adresse').value.trim();
    const postalCityInput = document.getElementById('postal-city').value.trim();

    if (!adresseInput || !postalCityInput) {
        alert("Adresse or Postal/City is empty!");
        return; // STOP if missing fields
    }

    const adresse = adresseInput.toUpperCase();
    const [postalCode, ...cityParts] = postalCityInput.split(' ');
    const city = cityParts.join(' ').toUpperCase();
    const customID = `${adresse} - ${postalCode} ${city}`;

    // BUILD PAYLOAD
    const payload = {
        id: customID,
        adresse: adresseInput,
        postalCity: postalCityInput,
        objet: document.getElementById('objet').value,
        date: document.getElementById('date').value,
        fiches: [...document.querySelectorAll('.fiches-techniques-row')].map(row => ({
            marque: row.querySelector('.marque-input').value,
            modele: row.querySelector('.modele-input').value
        }))
    };

    // DEBUG PAYLOAD IN BROWSER CONSOLE:
    console.log("CUSTOM ID:", customID);
    console.log("PAYLOAD SENDING TO BACKEND:", payload);

    // CORRECT FETCH WITH HEADERS:
    const response = await fetch('/.netlify/functions/save-progress', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' }, // REQUIRED!
        body: JSON.stringify(payload)
    });

    const result = await response.json();
    console.log("RESPONSE FROM BACKEND:", result);
    alert('Progress saved! ID: ' + result.id);
});

	
	document.getElementById('load-progress').addEventListener('click', async () => {
	    const id = prompt('Enter your progress ID:');
	
	    const response = await fetch('/.netlify/functions/load-progress', {
	        method: 'POST',
	        body: JSON.stringify({ id })
	    });
	
	    const data = await response.json();
	
	    // Populate your form with returned data
	    document.getElementById('adresse').value = data.adresse || '';
	    document.getElementById('postal-city').value = data.postalCity || '';
	    document.getElementById('objet').value = data.objet || '';
	    document.getElementById('date').value = data.date || '';
	
	    // Fill fiche rows
	    document.querySelectorAll('.fiches-techniques-row').forEach((row, i) => {
	        if (data.fiches[i]) {
	            row.querySelector('.marque-input').value = data.fiches[i].marque || '';
	            row.querySelector('.modele-input').value = data.fiches[i].modele || '';
	        }
	    });
	});
	</script>
</body>
</html>
